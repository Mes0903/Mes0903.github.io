<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.19" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.71" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://mes0903.github.io/risc-v/ACLINT/"><meta property="og:site_name" content="Mes's Blog"><meta property="og:title" content="RISC-V ACLINT"><meta property="og:description" content="RISC-V ACLINT specï¼šhttps://github.com/riscv/riscv-aclint/blob/main/riscv-aclint.adoc Introduction åŠŸèƒ½ :::spoiler åŸæ–‡ This RISC-V ACLINT specification defines a set of memory mappe..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2025-02-22T20:43:16.000Z"><meta property="article:tag" content="risc-v"><meta property="article:published_time" content="2024-12-11T00:00:00.000Z"><meta property="article:modified_time" content="2025-02-22T20:43:16.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"RISC-V ACLINT","image":[""],"datePublished":"2024-12-11T00:00:00.000Z","dateModified":"2025-02-22T20:43:16.000Z","author":[{"@type":"Person","name":"Mes","url":"https://mes0903.github.io"}]}</script><link rel="icon" href="/flame.ico"><title>RISC-V ACLINT | Mes's Blog</title><meta name="description" content="RISC-V ACLINT specï¼šhttps://github.com/riscv/riscv-aclint/blob/main/riscv-aclint.adoc Introduction åŠŸèƒ½ :::spoiler åŸæ–‡ This RISC-V ACLINT specification defines a set of memory mappe...">
    <link rel="preload" href="/assets/style-DW1OEkiQ.css" as="style"><link rel="stylesheet" href="/assets/style-DW1OEkiQ.css">
    <link rel="modulepreload" href="/assets/app-BcP8o8U4.js"><link rel="modulepreload" href="/assets/index.html-DjRvgdxh.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-BiEWK1GR.js" as="script"><link rel="prefetch" href="/assets/index.html-B_H8OoE4.js" as="script"><link rel="prefetch" href="/assets/index.html-B6QgGw1I.js" as="script"><link rel="prefetch" href="/assets/index.html-CfApM9ED.js" as="script"><link rel="prefetch" href="/assets/index.html-CsGh_Sko.js" as="script"><link rel="prefetch" href="/assets/index.html-CackVi67.js" as="script"><link rel="prefetch" href="/assets/index.html-ZJwihc1a.js" as="script"><link rel="prefetch" href="/assets/index.html-BLPTrtIz.js" as="script"><link rel="prefetch" href="/assets/index.html-BkR214TD.js" as="script"><link rel="prefetch" href="/assets/index.html-SiEU4OdJ.js" as="script"><link rel="prefetch" href="/assets/index.html-BvIw9pTT.js" as="script"><link rel="prefetch" href="/assets/index.html-BnqPezdy.js" as="script"><link rel="prefetch" href="/assets/index.html-C2EEiO23.js" as="script"><link rel="prefetch" href="/assets/AboutMovingForward.html-BVXUatD0.js" as="script"><link rel="prefetch" href="/assets/RasterI.html-DZu6U60_.js" as="script"><link rel="prefetch" href="/assets/index.html-BnPU3ndH.js" as="script"><link rel="prefetch" href="/assets/index.html-CDWGPQj5.js" as="script"><link rel="prefetch" href="/assets/index.html-BZAA8teD.js" as="script"><link rel="prefetch" href="/assets/index.html-B29x6D-I.js" as="script"><link rel="prefetch" href="/assets/index.html-d9TxGGlK.js" as="script"><link rel="prefetch" href="/assets/index.html-x0TChf0P.js" as="script"><link rel="prefetch" href="/assets/index.html-RUmwL0vR.js" as="script"><link rel="prefetch" href="/assets/index.html-DiP1_nrU.js" as="script"><link rel="prefetch" href="/assets/index.html-CWhwJJRF.js" as="script"><link rel="prefetch" href="/assets/index.html-DUBF5UHc.js" as="script"><link rel="prefetch" href="/assets/index.html-B1-KcoWy.js" as="script"><link rel="prefetch" href="/assets/risc-v_osdi.html-CF5-ccKo.js" as="script"><link rel="prefetch" href="/assets/index.html-ogpKYtWm.js" as="script"><link rel="prefetch" href="/assets/index.html-CLdwlagL.js" as="script"><link rel="prefetch" href="/assets/index.html-DsRYPjK6.js" as="script"><link rel="prefetch" href="/assets/index.html-BcHUWuuC.js" as="script"><link rel="prefetch" href="/assets/index.html-CFCnu_oK.js" as="script"><link rel="prefetch" href="/assets/index.html-b5wTyc_O.js" as="script"><link rel="prefetch" href="/assets/index.html-CfBwqcOE.js" as="script"><link rel="prefetch" href="/assets/index.html-BJxZQvsX.js" as="script"><link rel="prefetch" href="/assets/index.html-DM0Dryhz.js" as="script"><link rel="prefetch" href="/assets/index.html-Bdi3atey.js" as="script"><link rel="prefetch" href="/assets/index.html-Db6XWDF4.js" as="script"><link rel="prefetch" href="/assets/index.html-BIMDrBZh.js" as="script"><link rel="prefetch" href="/assets/index.html-1WitTtjF.js" as="script"><link rel="prefetch" href="/assets/index.html-BBc1mo51.js" as="script"><link rel="prefetch" href="/assets/index.html-Da_dn3sB.js" as="script"><link rel="prefetch" href="/assets/index.html-bcnvj3fg.js" as="script"><link rel="prefetch" href="/assets/index.html-DBjWceTq.js" as="script"><link rel="prefetch" href="/assets/index.html-CYG3E7BE.js" as="script"><link rel="prefetch" href="/assets/index.html-Byh5ax_b.js" as="script"><link rel="prefetch" href="/assets/index.html-CPX4-oWw.js" as="script"><link rel="prefetch" href="/assets/404.html-CH4Ibaef.js" as="script"><link rel="prefetch" href="/assets/index.html-728yCafu.js" as="script"><link rel="prefetch" href="/assets/index.html-lyIe0CpS.js" as="script"><link rel="prefetch" href="/assets/index.html-Wzc89aeg.js" as="script"><link rel="prefetch" href="/assets/index.html-EsIA7Wqr.js" as="script"><link rel="prefetch" href="/assets/index.html-CRq7Djss.js" as="script"><link rel="prefetch" href="/assets/index.html-BNg86-sq.js" as="script"><link rel="prefetch" href="/assets/index.html-BuPK7MMf.js" as="script"><link rel="prefetch" href="/assets/index.html-CXd-1WE2.js" as="script"><link rel="prefetch" href="/assets/index.html-BPYKVIQl.js" as="script"><link rel="prefetch" href="/assets/index.html-Du47nPb9.js" as="script"><link rel="prefetch" href="/assets/index.html-BcGBAPVR.js" as="script"><link rel="prefetch" href="/assets/index.html-Bz_MoDKk.js" as="script"><link rel="prefetch" href="/assets/index.html-Cy6boZwT.js" as="script"><link rel="prefetch" href="/assets/index.html-Bgc2pn_w.js" as="script"><link rel="prefetch" href="/assets/index.html-Dqr7MINQ.js" as="script"><link rel="prefetch" href="/assets/index.html-B_kkQH4U.js" as="script"><link rel="prefetch" href="/assets/index.html-BrdzQkpQ.js" as="script"><link rel="prefetch" href="/assets/index.html-Blq7aT-q.js" as="script"><link rel="prefetch" href="/assets/index.html-axLJhkf5.js" as="script"><link rel="prefetch" href="/assets/index.html-DBWaheD3.js" as="script"><link rel="prefetch" href="/assets/index.html-DGxj-483.js" as="script"><link rel="prefetch" href="/assets/index.html-CarUXHpG.js" as="script"><link rel="prefetch" href="/assets/index.html-BHE8pNse.js" as="script"><link rel="prefetch" href="/assets/index.html-Dd-niVBl.js" as="script"><link rel="prefetch" href="/assets/index.html-BM7yhHKu.js" as="script"><link rel="prefetch" href="/assets/index.html-DL9y76Vc.js" as="script"><link rel="prefetch" href="/assets/index.html-DJXfLGA7.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-DXWKOczD.js" as="script"><link rel="prefetch" href="/assets/index-B-M8YVCw.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-slnMg1Ma.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><!--[--><div class="theme-container no-sidebar external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="Take me home"><img class="vp-nav-logo" src="/flame.jpg" alt><!----><span class="vp-site-name hide-in-pad">Mes&#39;s Blog</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!----><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->RISC-V ACLINT</h1><div class="page-info"><span class="page-author-info" aria-label="AuthorğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mes0903.github.io" target="_blank" rel="noopener noreferrer">Mes</a></span><span property="author" content="Mes"></span></span><!----><span class="page-date-info" aria-label="Writing DateğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">December 11, 2024</span><meta property="datePublished" content="2024-12-11T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 12 min</span><meta property="timeRequired" content="PT12M"></span><span class="page-category-info" aria-label="CategoryğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color8 clickable" role="navigation">risc-v</span><!--]--><meta property="articleSection" content="risc-v"></span><span class="page-tag-info" aria-label="TagğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color8 clickable" role="navigation">risc-v</span><!--]--><meta property="keywords" content="risc-v"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><!--[--><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#introduction-1">Introduction</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#register-map">Register Map</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mtime-register-offset-0x00000000">MTIME Register (Offset: 0x00000000)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mtimecmp-registers-offsets-0x00000000-0x00007ff0">MTIMECMP Registers (Offsets: 0x00000000 - 0x00007FF0)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#synchronizing-multiple-mtime-registers">Synchronizing Multiple MTIME Registers</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#introduction-2">Introduction</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#register-map-1">Register Map</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#msip-registers-offsets-0x00000000-0x00003ff8">MSIP Registers (Offsets: 0x00000000 - 0x00003FF8)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#introduction-3">Introduction</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#register-map-2">Register Map</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#setssip-registers-offsets-0x00000000-0x00003ff8">SETSSIP Registers (Offsets: 0x00000000 - 0x00003FF8)</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--]--><!----></aside></div><!----><div class="theme-hope-content" vp-content><h1 id="risc-v-aclint" tabindex="-1"><a class="header-anchor" href="#risc-v-aclint"><span>RISC-V ACLINT</span></a></h1><ul><li>specï¼š<a href="https://github.com/riscv/riscv-aclint/blob/main/riscv-aclint.adoc" target="_blank" rel="noopener noreferrer">https://github.com/riscv/riscv-aclint/blob/main/riscv-aclint.adoc</a></li></ul><h1 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"><span>Introduction</span></a></h1><ol><li><p>åŠŸèƒ½<br> :::spoiler åŸæ–‡</p><blockquote><p>This RISC-V ACLINT specification defines a set of memory mapped devices which provide inter-processor interrupts (IPI) and timer functionalities for each HART on a multi-HART RISC-V platform.<br> :::</p></blockquote><p>ACLINT æ˜¯ä¸€çµ„ memory mapped devicesï¼Œç”¨æ–¼åœ¨ multi-hart çš„ RISC-V å¹³å°ä¸Šæä¾›</p><ul><li>inter-processor interrupts (IPI)</li><li>å®šæ™‚å™¨åŠŸèƒ½ (Timer functionalities)</li></ul></li><li><p>CLINT çš„å±€é™æ€§<br> :::spoiler åŸæ–‡</p><blockquote><p>The SiFive Core-Local Interruptor (CLINT) device has been widely adopted in the RISC-V world to provide machine-level IPI and timer functionalities.</p><p>Unfortunately, the SiFive CLINT has a unified register map for both IPI and timer functionalities and it does not provide supervisor-level IPI functionality.<br> :::</p></blockquote><ul><li>CLINT åœ¨ RISC-V å¹³å°ä¸Šå»£æ³›ç”¨æ–¼æä¾› Machine-level çš„ IPI å’Œå®šæ™‚å™¨åŠŸèƒ½</li><li>å±€é™æ€§ <ul><li>unified register map <ul><li>CLINT å°‡ IPI å’Œå®šæ™‚å™¨åŠŸèƒ½çš„æš«å­˜å™¨æ”¾åœ¨ä¸€å€‹çµ±ä¸€çš„åœ°å€ç©ºé–“ä¸­</li></ul></li><li>ç¼ºä¹ supervisor-level IPI</li></ul></li></ul></li><li><p>ACLINT çš„æ”¹é€²<br> :::spoiler åŸæ–‡</p><blockquote><p>The RISC-V ACLINT specification takes a more modular approach by defining separate memory mapped devices for IPI and timer functionalities.</p><p>This modularity allows RISC-V platforms to omit some of the RISC-V ACLINT devices for when the platform has an alternate mechanism.</p><p>In addition to modularity, the RISC-V ACLINT specification also defines a dedicated memory mapped device for supervisor-level IPIs.<br> :::</p></blockquote><ul><li>modularity <ul><li>ACLINT å°‡ IPI å’Œå®šæ™‚å™¨åŠŸèƒ½åˆ†åˆ¥å®šç¾©ç‚ºç¨ç«‹çš„ memory mapped device</li><li>å¦‚æœå¹³å°æœ‰æ›¿ä»£æ©Ÿåˆ¶ï¼Œå¯ä»¥é¸æ“‡æ€§åœ°çœç•¥éƒ¨åˆ† ACLINT è¨­å‚™</li></ul></li><li>å¦å¤– ACLINT å®šç¾©äº†å°ˆé–€çš„ memory mapped device ä¾†æ”¯æŒ supervisor-level IPIï¼Œå¡«è£œäº† CLINT çš„åŠŸèƒ½ç©ºç¼º</li></ul></li><li><p>ACLINT Devices</p><table><thead><tr><th>Name</th><th>Privilege Level</th><th>Functionality</th></tr></thead><tbody><tr><td>MTIMER</td><td>Machine</td><td>Fixed-frequency counter and timer events</td></tr><tr><td>MSWI</td><td>Machine</td><td>Inter-processor (or software) interrupts</td></tr><tr><td>SSWI</td><td>Supervisor</td><td>Inter-processor (or software) interrupts</td></tr></tbody></table></li><li><p>èˆ‡ SiFive CLINT çš„å…¼å®¹æ€§<br> :::spoiler åŸæ–‡</p><blockquote><p>The RISC-V ACLINT specification is defined to be backward compatible with the SiFive CLINT specification.</p><p>The register definitions and register offsets of the MTIMER and MSWI devices are compatible with the timer and IPI registers defined by the SiFive CLINT specification.<br> :::</p></blockquote><ul><li>ACLINT çš„ MTIMER å’Œ MSWI è¨­å‚™çš„æš«å­˜å™¨å®šç¾©å’Œåç§»é‡èˆ‡ SiFive CLINT ä¸­çš„å®šæ™‚å™¨å’Œ IPI æš«å­˜å™¨ä¿æŒä¸€è‡´</li></ul></li><li><p>CLINT èˆ‡ ACLINT çš„é‚è¼¯é—œä¿‚</p><p>SiFive CLINT è¨­å‚™å¯ä»¥è¢«é‚è¼¯åœ°è¦–ç‚ºå…©å€‹ ACLINT è¨­å‚™çš„çµ„åˆ</p><table><thead><tr><th>SiFive CLINT Offset Range</th><th>ACLINT Device</th><th>Functionality</th></tr></thead><tbody><tr><td>0x0000_0000 - 0x0000_3fff</td><td>MSWI</td><td>Machine-level inter-processor (or software) interrupts</td></tr><tr><td>0x0000_4000 - 0x0000_bfff</td><td>MTIMER</td><td>Machine-level fixed-frequency counter and timer events</td></tr></tbody></table><ul><li>MSWIï¼šå°æ‡‰ CLINT åœ°å€ç¯„åœ 0x0000_0000 - 0x0000_3fffï¼Œæä¾› Machine-level IPI</li><li>MTIMERï¼šå°æ‡‰ CLINT åœ°å€ç¯„åœ 0x0000_4000 - 0x0000_bfffï¼Œæä¾› Machine-level å®šæ™‚å™¨åŠŸèƒ½</li></ul></li></ol><h1 id="machine-level-timer-device-mtimer" tabindex="-1"><a class="header-anchor" href="#machine-level-timer-device-mtimer"><span>Machine-level Timer Device (MTIMER)</span></a></h1><h2 id="introduction-1" tabindex="-1"><a class="header-anchor" href="#introduction-1"><span>Introduction</span></a></h2><p>:::spoiler åŸæ–‡</p><blockquote><p>The MTIMER device provides machine-level timer functionality for a set of HARTs on a RISC-V platform.</p><p>It has a single fixed-frequency monotonic time counter (<code>MTIME</code>) register and a time compare register (<code>MTIMECMP</code>) for each HART connected to the MTIMER device.</p><p>A MTIMER device not connected to any HART should only have a <code>MTIME</code> register and no <code>MTIMECMP</code> registers.<br> :::</p></blockquote><ul><li>MTIMER ç‚ºä¸€çµ„ HART æä¾› Machine-level çš„å®šæ™‚å™¨åŠŸèƒ½ï¼Œç”¨æ–¼æ”¯æŒè¨ˆæ™‚å’Œç”¢ç”Ÿå®šæ™‚å™¨ä¸­æ–·</li><li><code>MTIME</code> Register <ul><li>æ¯å€‹ HART æœ‰ä¸€å€‹å°æ‡‰çš„ <code>MTIME</code> Registerï¼Œå…¶æ˜¯ä¸€å€‹å–®èª¿éå¢çš„å›ºå®šé »ç‡æ™‚é–“è¨ˆæ•¸å™¨ï¼Œé©ç”¨æ–¼æ‰€æœ‰é€£æ¥åˆ° MTIMER çš„ HART</li></ul></li><li><code>MTIMECMP</code> Register <ul><li>æ¯å€‹ HART æœ‰ä¸€å€‹å°æ‡‰çš„ <code>MTIMECMP</code> Registerï¼Œä½œç‚ºå°æ‡‰çš„æ™‚é–“æ¯”è¼ƒæš«å­˜å™¨</li><li>ç•¶ <code>MTIME</code> çš„å€¼é”åˆ°æˆ–è¶…é <code>MTIMECMP</code> çš„å€¼æ™‚ï¼Œè§¸ç™¼ Machine-level çš„å®šæ™‚å™¨ä¸­æ–·</li></ul></li><li>å¦‚æœ MTIMER æ²’æœ‰é€£æ¥åˆ°ä»»ä½• HART <ul><li>å®ƒæ‡‰è©²åªåŒ…å« <code>MTIME</code> æš«å­˜å™¨</li><li>ä¸éœ€è¦åŒ…å«ä»»ä½• <code>MTIMECMP</code> æš«å­˜å™¨ï¼Œå› ç‚ºæ²’æœ‰ HART éœ€è¦æ™‚é–“æ¯”è¼ƒåŠŸèƒ½</li></ul></li></ul><p>:::spoiler åŸæ–‡</p><blockquote><p>On a RISC-V platform with multiple MTIMER devices:</p><ul><li><p>Each MTIMER device provides machine-level timer functionality for a different<br> (or disjoint) set of HARTs.</p><p>A MTIMER device assigns a HART index starting from zero to each HART associated with it.</p><p>The HART index assigned to a HART by the MTIMER device may or may not have any relationship with the unique HART identifier (<em>hart ID</em>) that the RISC-V Privileged Architecture assigns to the HART.</p></li><li><p>Two or more MTIMER devices can share the same physical MTIME register while having their own separate MTIMECMP registers.</p></li><li><p>The MTIMECMP registers of a MTIMER device must only compare against the MTIME register of the same MTIMER device for generating machine-level timer interrupt.</p></li></ul><p>The maximum number of HARTs supported by a single MTIMER device is 4095 which is equivalent to the maximum number of MTIMECMP registers.<br> :::</p></blockquote><ul><li>æ¯å€‹ MTIMER è¨­å‚™åªè² è²¬ä¸€çµ„ä¸åŒï¼ˆæˆ–ä¸ç›¸äº¤ï¼‰çš„ HART çš„ machine-level å®šæ™‚å™¨åŠŸèƒ½</li><li>HART Index <ul><li>MTIMER å°‡å¾ 0 é–‹å§‹åˆ†é… index çµ¦æ‰€é€£æ¥çš„ HART</li><li>index èˆ‡ RISC-V ç‰¹æ¬Šæ¶æ§‹åˆ†é…çš„ HART ID ä¸ä¸€å®šæœ‰é—œ</li></ul></li><li><code>MTIME</code> æš«å­˜å™¨å…±äº« <ul><li>å¤šå€‹ MTIMER è¨­å‚™å¯ä»¥å…±ç”¨ä¸€å€‹ç‰©ç†ä¸Šçš„ <code>MTIME</code> æš«å­˜å™¨</li><li>ä½† MTIMER è¨­å‚™ä»æ“æœ‰ç¨ç«‹çš„ <code>MTIMECMP</code> æš«å­˜å™¨ï¼Œç¢ºä¿æ¯å€‹ HART çš„æ¯”è¼ƒå’Œä¸­æ–·è™•ç†æ˜¯åˆ†é–‹çš„</li></ul></li><li><code>MTIMECMP</code> çš„æ¯”è¼ƒè¦å‰‡ <ul><li><code>MTIMECMP</code> æš«å­˜å™¨åªèƒ½èˆ‡åŒä¸€ MTIMER è¨­å‚™çš„ <code>MTIME</code> æš«å­˜å™¨é€²è¡Œæ¯”è¼ƒ</li><li>é€™ç¨®è¨­è¨ˆç¢ºä¿ä¸­æ–·ç”± MTIMER è¨­å‚™å…§éƒ¨ç¨ç«‹ç®¡ç†</li></ul></li><li>æ¯å€‹ MTIMER è¨­å‚™æœ€å¤šæ”¯æŒ 4095 å€‹ HART <ul><li>é€™èˆ‡æœ€å¤šæ”¯æŒ 4095 å€‹ MTIMECMP æš«å­˜å™¨ç›¸å°æ‡‰</li></ul></li></ul><h2 id="register-map" tabindex="-1"><a class="header-anchor" href="#register-map"><span>Register Map</span></a></h2><p>:::spoiler åŸæ–‡</p><blockquote><p>A MTIMER device has two separate base addresses: one for the MTIME register and another for the MTIMECMP registers.</p><p>These separate base addresses of a single MTIMER device allows multiple MTIMER devices to share the same physical MTIME register.<br> :::</p></blockquote><ul><li>MTIMER è¨­å‚™æœ‰å…©å€‹ base addresses <ul><li><code>MTIME</code> Register Base Addressï¼šæä¾› Machine-level çš„æ™‚é–“è¨ˆæ•¸åŠŸèƒ½</li><li><code>MTIMECMP</code> Registers Base Addressï¼šç‚ºæ¯å€‹ HART æä¾›ç¨ç«‹çš„æ™‚é–“æ¯”è¼ƒåŠŸèƒ½</li><li>ç”¨ä¾†ä½¿ä¸åŒçš„ MTIMER è¨­å‚™å¯ä»¥å…±äº«ä¸€å€‹ç‰©ç†ä¸Šçš„ <code>MTIME</code> æš«å­˜å™¨ï¼Œä½†æ“æœ‰ç¨ç«‹çš„ MTIMECMP æš«å­˜å™¨</li></ul></li></ul><p>ACLINT MTIMER Time Register Mapï¼š</p><table><thead><tr><th>Offset</th><th>Width</th><th>Attr</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>0x0000_0000</td><td>8B</td><td>RW</td><td>MTIME</td><td>Machine-level time counter</td></tr></tbody></table><p>ACLINT MTIMER Compare Register Mapï¼š</p><table><thead><tr><th>Offset</th><th>Width</th><th>Attr</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>0x0000_0000</td><td>8B</td><td>RW</td><td>MTIMECMP0</td><td>HART index 0 machine-level time compare</td></tr><tr><td>0x0000_0008</td><td>8B</td><td>RW</td><td>MTIMECMP1</td><td>HART index 1 machine-level time compare</td></tr><tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><td>0x0000_7FF0</td><td>8B</td><td>RW</td><td>MTIMECMP4094</td><td>HART index 4094 machine-level time compare</td></tr></tbody></table><h2 id="mtime-register-offset-0x00000000" tabindex="-1"><a class="header-anchor" href="#mtime-register-offset-0x00000000"><span>MTIME Register (Offset: 0x00000000)</span></a></h2><p>:::spoiler åŸæ–‡</p><blockquote><p>The <code>MTIME</code> register is a 64-bit read-write register that contains the number of cycles counted based on a fixed reference frequency.</p><p>On MTIMER device reset, the MTIME register is cleared to zero.<br> :::</p></blockquote><ul><li><code>MTIME</code> ç‚º 64-bit Read-Write æš«å­˜å™¨</li><li>ç”¨æ–¼å­˜å„²åŸºæ–¼å›ºå®šåƒè€ƒé »ç‡ï¼ˆfixed reference frequencyï¼‰çš„è¨ˆæ•¸å™¨å€¼</li><li>MTIMER reset æ™‚ï¼Œæš«å­˜å™¨çš„å€¼æ¸…ç‚º 0</li><li>æä¾›å–®èª¿éå¢çš„æ™‚é–“åŸºæº–ï¼Œä¾› <code>MTIMECMP</code> æš«å­˜å™¨é€²è¡Œæ¯”è¼ƒ</li><li>ç”¨æ–¼è§¸ç™¼ Machine-level timer ä¸­æ–·</li></ul><h2 id="mtimecmp-registers-offsets-0x00000000-0x00007ff0" tabindex="-1"><a class="header-anchor" href="#mtimecmp-registers-offsets-0x00000000-0x00007ff0"><span>MTIMECMP Registers (Offsets: 0x00000000 - 0x00007FF0)</span></a></h2><p>:::spoiler åŸæ–‡</p><blockquote><p>The <code>MTIMECMP</code> registers are per-HART 64-bit read-write registers.</p><p>It contains the <code>MTIME</code> register value at which machine-level timer interrupt is to be triggered for the corresponding HART.<br> :::</p></blockquote><ul><li>æ¯å€‹ HART åˆ†é…ä¸€å€‹å°æ‡‰çš„ 64-bit Read-Write <code>MTIMECMP</code> æš«å­˜å™¨</li><li>å­˜å„²ä¸€å€‹ Target Valueï¼Œç•¶ <code>MTIME</code> çš„å€¼é”åˆ°æˆ–è¶…éæ­¤å€¼æ™‚ï¼Œå°æ‡‰çš„ HART æœƒè§¸ç™¼ Machine-level timer ä¸­æ–·</li></ul><p>:::spoiler åŸæ–‡</p><blockquote><p>The machine-level timer interrupt of a HART is pending whenever <code>MTIME</code> is greater than or equal to the value in the corresponding <code>MTIMECMP</code> register.</p><p>The machine-level timer interrupt of a HART is cleared whenever <code>MTIME</code> is less than the value of the corresponding <code>MTIMECMP</code> register.</p><p>The machine-level timer interrupt is reflected in the MTIP bit of the <code>mip</code> CSR.</p><p>On MTIMER device reset, the <code>MTIMECMP</code> registers are in unknown state.<br> :::</p></blockquote><ul><li>ä¸­æ–·è§¸ç™¼æ¢ä»¶ï¼š <ul><li>ç•¶ <code>MTIME &gt;= MTIMECMP</code> æ™‚ï¼Œå°æ‡‰ HART çš„ Machine-level timer ä¸­æ–·è™•æ–¼ pending ç‹€æ…‹</li></ul></li><li>ä¸­æ–·æ¸…é™¤æ¢ä»¶ï¼š <ul><li>ç•¶ <code>MTIME &lt; MTIMECMP</code> æ™‚ï¼Œå°æ‡‰ HART çš„ Machine-level timer ä¸­æ–·è¢«æ¸…é™¤</li></ul></li><li>ä¸­æ–·ç‹€æ…‹æœƒåæ˜ åœ¨æ¯å€‹ HART çš„ <code>mip</code> CSR çš„ MTIP bit</li><li>MTIMER è¨­å‚™é‡ç½®å¾Œï¼Œæ‰€æœ‰ <code>MTIMECMP</code> æš«å­˜å™¨è™•æ–¼æœªçŸ¥ç‹€æ…‹</li></ul><h2 id="synchronizing-multiple-mtime-registers" tabindex="-1"><a class="header-anchor" href="#synchronizing-multiple-mtime-registers"><span>Synchronizing Multiple MTIME Registers</span></a></h2><p>:::spoiler åŸæ–‡</p><blockquote><p>A RISC-V platform can have multiple HARTs grouped into hierarchical topology groups (such as clusters, nodes, or sockets) where each topology group has its own MTIMER device.</p><p>Further, such RISC-V platforms can also allow clock-gating or powering off for a topology group (including the MTIMER device) at runtime.<br> :::</p></blockquote><ul><li>åœ¨å¤š HART çš„ RISC-V å¹³å°ä¸Šï¼ŒHART å¯ä»¥æŒ‰ç…§ clustersã€nodes æˆ– sockets åŠƒåˆ†ç‚ºæ‹“æ’²çµ„ï¼Œæ¯å€‹æ‹“æ’²çµ„å¯ä»¥æ“æœ‰ç¨ç«‹çš„ MTIMER è¨­å‚™</li><li>å¹³å°å¯ä»¥å…è¨±å°æ•´å€‹æ‹“æ’²çµ„ï¼ˆåŒ…æ‹¬ MTIMER è¨­å‚™ï¼‰é€²è¡Œ clock-gating æˆ–é—œæ©Ÿçš„æ“ä½œ</li></ul><p>:::spoiler åŸæ–‡</p><blockquote><p>On a RISC-V platform with multiple MTIMER devices residing on the same die, each device must satisfy the RISC-V architectural requirement that all the <code>MTIME</code> registers with respect to each other, and all the per-HART time CSRs with respect to each other, are synchronized to within one <code>MTIME</code> tick period.</p><p>For example, if the <code>MTIME</code> tick period is 10ns, then the <code>MTIME</code> registers, and their associated <code>time</code> CSRs, should respectively be synchronized to within 10ns of each other.<br> :::</p></blockquote><ul><li>åŒä¸€æ™¶ç‰‡å…§ <ul><li>æ‰€æœ‰ <code>MTIME</code> Registers å’Œæ¯å€‹ HART çš„ <code>time</code> CSRs å¿…é ˆåœ¨ä¸€å€‹ MTIME tick é€±æœŸå…§åŒæ­¥</li><li>èˆ‰ä¾‹ä¾†èªªï¼Œè‹¥ <code>MTIME</code> tick period ç‚º 10nsï¼Œå‰‡åŒæ­¥åå·®æ‡‰é™åˆ¶åœ¨ 10ns å…§</li></ul></li></ul><p>:::spoiler åŸæ–‡</p><blockquote><p>On a RISC-V platform with multiple MTIMER devices on different die, the <code>MTIME</code> registers (and their associated time CSRs) on different die may be synchronized to only within a specified interval of each other that is larger than the <code>MTIME</code> tick period.</p><p>A platform may define a maximum allowed interval.<br> :::</p></blockquote><ul><li>ä¸åŒæ™¶ç‰‡ä¸­ <ul><li>å„æ™¶ç‰‡çš„ <code>MTIME</code> Registers å’Œ <code>time</code> CSRs å¯ä»¥å…è¨±æ›´å¤§çš„åŒæ­¥åå·®</li><li>å¹³å°å¯å®šç¾©å…è¨±çš„æœ€å¤§åŒæ­¥é–“éš”</li></ul></li></ul><p>:::spoiler åŸæ–‡</p><blockquote><p>To satisfy the preceding <code>MTIME</code> synchronization requirements:</p><ul><li><p>All <code>MTIME</code> registers should have the same input clock so as to avoid runtime drift between separate <code>MTIME</code> registers (and their associated <code>time</code> CSRs)</p></li><li><p>Upon system reset, the hardware must initialize and synchronize all <code>MTIME</code> registers to zero</p></li><li><p>When a MTIMER device is stopped and started again due to, say, power management actions, the software should re-synchronize this <code>MTIME</code> register with all other <code>MTIME</code> registers<br> :::</p></li></ul></blockquote><ul><li>æ‰€æœ‰ <code>MTIME</code> Registers æ‡‰ä½¿ç”¨ç›¸åŒçš„è¼¸å…¥æ™‚é˜ï¼Œé¿å…é‹è¡Œæ™‚çš„æ™‚é˜æœ‰èª¤å·®</li><li>ç³»çµ±é‡ç½®æ™‚ï¼Œç¡¬é«”éœ€åˆå§‹åŒ–ä¸¦åŒæ­¥æ‰€æœ‰ <code>MTIME</code> Registers ç‚ºé›¶</li><li>ç•¶ MTIMER å› åŠŸè€—ç®¡ç†ç­‰åŸå› åœæ­¢ä¸¦é‡æ–°å•Ÿå‹•æ™‚ï¼Œè»Ÿé«”éœ€é‡æ–°å°‡è©² <code>MTIME</code> Register èˆ‡å…¶ä»– <code>MTIME</code> Registers åŒæ­¥</li></ul><p>:::spoiler åŸæ–‡</p><blockquote><p>When software updates one, multiple, or all <code>MTIME</code> registers, it must maintain the preceding synchronization requirements (through measuring and then taking into account the differing latencies of performing reads or writes to the different MTIME registers).<br> :::</p></blockquote><ul><li>ç•¶è»Ÿé«”æ›´æ–° <code>MTIME</code> Registers æ™‚ï¼Œéœ€æ¸¬é‡ä¸¦è£œå„Ÿä¸åŒæš«å­˜å™¨çš„è®€å¯«å»¶é²ä»¥æ»¿è¶³å‰é¢çš„åŒæ­¥è¦æ±‚</li></ul><p>:::spoiler åŸæ–‡</p><blockquote><p>As an example, the below RISC-V 64-bit assembly sequence can be used by software to synchronize a <code>MTIME</code> register with reference to another <code>MTIME</code> register.</p><p><strong>NOTE:</strong> On some RISC-V platforms, the MTIME synchronization sequence (i.e. the aclint_mtime_sync() function above) will need to be repeated few times until delta between target MTIME register and reference MTIME register is zero (or very close to zero).<br> :::</p></blockquote><p>ä»¥ä¸‹ç‚ºä¸€ç¯„ä¾‹ asm codeï¼Œå°‡ç›®æ¨™ <code>MTIME</code> Register èˆ‡åƒè€ƒ <code>MTIME</code> Register é€²è¡ŒåŒæ­¥ï¼š</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" data-title="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">/*</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> * unsigned long aclint_mtime_sync(unsigned long target_mtime_address,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> *                                 unsigned long reference_mtime_address)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> */</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        .globl aclint_mtime_sync</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">aclint_mtime_sync:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        /* Read target MTIME register in T0 register */</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ld        t0, (a0)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        fence     i, i</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        /* Read reference MTIME register in T1 register */</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ld        t1, (a1)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        fence     i, i</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        /* Read target MTIME register in T2 register */</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ld        t2, (a0)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        fence     i, i</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        /*</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         * Compute target MTIME adjustment in T3 register</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         * T3 = T1 - ((T0 + T2) / 2)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         */</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        srli      t0, t0, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        srli      t2, t2, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        add       t3, t0, t2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        sub       t3, t1, t3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        /* Update target MTIME register */</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ld        t4, (a0)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        add       t4, t4, t3</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        sd        t4, (a0)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        /* Return MTIME adjustment value */</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        add       a0, t3, zero</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ret</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸäº›å¹³å°å¯èƒ½éœ€è¦å¤šæ¬¡é‡è¤‡åŒæ­¥éç¨‹ï¼Œç›´åˆ°ç›®æ¨™èˆ‡åƒè€ƒ <code>MTIME</code> Register ä¹‹é–“çš„åå·®æ¥è¿‘é›¶</p><h1 id="machine-level-software-interrupt-device-mswi" tabindex="-1"><a class="header-anchor" href="#machine-level-software-interrupt-device-mswi"><span>Machine-level Software Interrupt Device (MSWI)</span></a></h1><h2 id="introduction-2" tabindex="-1"><a class="header-anchor" href="#introduction-2"><span>Introduction</span></a></h2><p>:::spoiler åŸæ–‡</p><blockquote><p>The MSWI device provides machine-level IPI functionality for a set of HARTs on a RISC-V platform.</p><p>It has an IPI register (<code>MSIP</code>) for each HART connected to the MSWI device.</p><p>On a RISC-V platform with multiple MSWI devices, each MSWI device provides machine-level IPI functionality for a different (or disjoint) set of HARTs.</p><p>A MSWI device assigns a HART index starting from zero to each HART associated with it.</p><p>The HART index assigned to a HART by the MSWI device may or may not have any relationship with the unique HART identifier (hart ID) that the RISC-V Privileged Architecture assigns to the HART.</p><p>The maximum number of HARTs supported by a single MSWI device is 4095 which is equivalent to the maximum number of <code>MSIP</code> registers.<br> :::</p></blockquote><ul><li>MSWI è¨­å‚™ç‚ºä¸€çµ„ HART æä¾› Machine-level IPI çš„åŠŸèƒ½</li><li>å°æ–¼é€£æ¥åˆ° MSWI è¨­å‚™çš„æ¯å€‹ HARTï¼Œå®ƒéƒ½æœ‰ä¸€å€‹å°æ‡‰çš„ IPI æš«å­˜å™¨ï¼ˆMSIPï¼‰</li><li>ä¸€å€‹å¹³å°å¯ä»¥æœ‰å¤šå€‹ MSWI è¨­å‚™ï¼Œæ¯å€‹è¨­å‚™è² è²¬ä¸åŒï¼ˆæˆ–ä¸ç›¸äº¤ï¼‰çš„ä¸€çµ„ HART</li><li>HART Index <ul><li>æ¯å€‹ MSWI è¨­å‚™å¾ index 0 é–‹å§‹ç‚ºå…¶é€£æ¥çš„ HART åˆ†é…ä¸€å€‹ HART index</li><li>è©² index ç”¨æ–¼æ¨™è­˜ HARTï¼Œä½†ä¸ä¸€å®šèˆ‡ RISC-V ç‰¹æ¬Šæ¶æ§‹åˆ†é…çš„ HART ID æœ‰é—œ</li></ul></li><li>æ¯å€‹ MSWI è¨­å‚™æœ€å¤šæ”¯æŒ 4095 å€‹ HARTï¼Œé€™èˆ‡æœ€å¤šæ”¯æŒ 4095 å€‹ <code>MSIP</code> Registers ç›¸å°æ‡‰</li></ul><h2 id="register-map-1" tabindex="-1"><a class="header-anchor" href="#register-map-1"><span>Register Map</span></a></h2><p>ACLINT MSWI Device Register Mapï¼š</p><table><thead><tr><th>Offset</th><th>Width</th><th>Attr</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>0x0000_0000</td><td>4B</td><td>RW</td><td>MSIP0</td><td>HART index 0 machine-level IPI register</td></tr><tr><td>0x0000_0004</td><td>4B</td><td>RW</td><td>MSIP1</td><td>HART index 1 machine-level IPI register</td></tr><tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><td>0x0000_3FFC</td><td>4B</td><td></td><td>RESERVED</td><td>Reserved for future use.</td></tr></tbody></table><ul><li>addresse offset <ul><li>ç¬¬ 0 å€‹ HART çš„ MSIP ä½æ–¼ 0x0000_0000</li><li>ç¬¬ 1 å€‹ HART çš„ MSIP ä½æ–¼ 0x0000_0004</li><li>ä¾æ­¤é¡æ¨ï¼Œæ¯å€‹æš«å­˜å™¨å ç”¨ 4 å­—ç¯€ï¼ˆ32 ä½ï¼‰</li></ul></li><li>åœ°å€ç¯„åœ 0x0000_3FFC ç‚ºä¿ç•™å€åŸŸï¼Œç”¨æ–¼æœªä¾†æ“´å±•</li></ul><h2 id="msip-registers-offsets-0x00000000-0x00003ff8" tabindex="-1"><a class="header-anchor" href="#msip-registers-offsets-0x00000000-0x00003ff8"><span>MSIP Registers (Offsets: 0x00000000 - 0x00003FF8)</span></a></h2><p>:::spoiler åŸæ–‡</p><blockquote><p>Each MSIP register is a 32-bit wide WARL register where the upper 31 bits are wired to zero.</p><p>The least significant bit is reflected in MSIP of the <code>mip</code> CSR.</p><p>A machine-level software interrupt for a HART is pending or cleared by writing <code>1</code> or <code>0</code> respectively to the corresponding MSIP register.</p><p>On MSWI device reset, each MSIP register is cleared to zero.<br> :::</p></blockquote><ul><li>æ¯å€‹ <code>MSIP</code> æš«å­˜å™¨éƒ½æ˜¯ä¸€å€‹ 32 ä½å…ƒå¯¬çš„ WARL æš«å­˜å™¨</li><li>é«˜ 31 ä½ç¡¬æ¥ç·šç‚º 0</li><li>æœ€ä½æœ‰æ•ˆä½ï¼ˆLSBï¼‰åæ˜  <code>mip</code> CSR çš„ MSIP bit</li><li>å¯«å…¥ <code>1</code> å¯è¨­ç½®ä¸­æ–·æ›èµ·</li><li>å¯«å…¥ <code>0</code> å¯æ¸…é™¤ä¸­æ–·</li><li>MSWI è¨­å‚™é‡è¨­æ™‚ï¼Œæ¯å€‹ <code>MSIP</code> æš«å­˜å™¨éƒ½æ¸…é›¶</li></ul><h1 id="supervisor-level-software-interrupt-device-sswi" tabindex="-1"><a class="header-anchor" href="#supervisor-level-software-interrupt-device-sswi"><span>Supervisor-level Software Interrupt Device (SSWI)</span></a></h1><h2 id="introduction-3" tabindex="-1"><a class="header-anchor" href="#introduction-3"><span>Introduction</span></a></h2><p>:::spoiler åŸæ–‡</p><blockquote><p>The SSWI device provides supervisor-level IPI functionality for a set of HARTs on a RISC-V platform.</p><p>It provides a register to set an IPI (<code>SETSSIP</code>) for each HART connected to the SSWI device.<br> :::</p></blockquote><ul><li>SSWI è¨­å‚™ç‚ºä¸€çµ„ HART æä¾› Supervisor-level IPI åŠŸèƒ½</li><li>å°æ–¼é€£æ¥åˆ° SSWI è¨­å‚™çš„æ¯å€‹ HARTï¼Œå®ƒéƒ½æœ‰ä¸€å€‹å°æ‡‰çš„ IPI æš«å­˜å™¨ï¼ˆ<code>SETSSIP</code>ï¼‰</li></ul><p>:::spoiler åŸæ–‡</p><blockquote><p>On a RISC-V platform with multiple SSWI devices, each SSWI device provides supervisor-level IPI functionality for a different (or disjoint) set of HARTs.</p><p>A SSWI device assigns a HART index starting from zero to each HART associated with it.</p><p>The HART index assigned to a HART by the SSWI device may or may not have any relationship with the unique HART identifier (hart ID) that the RISC-V Privileged Architecture assigns to the HART.</p><p>The maximum number of HARTs supported by a single SSWI device is 4095 which is equivalent to the maximum number of <code>SETSSIP</code> registers.<br> :::</p></blockquote><ul><li>åœ¨å…·æœ‰å¤šå€‹ SSWI è¨­å‚™çš„ RISC-V å¹³å°ä¸Šï¼Œæ¯å€‹ SSWI è¨­å‚™ç‚ºä¸åŒï¼ˆæˆ–ä¸ç›¸äº¤ï¼‰çš„ä¸€çµ„ HART æä¾› Supervisor-level IPI åŠŸèƒ½</li><li>HART Index <ul><li>æ¯å€‹ SSWI è¨­å‚™å¾ index 0 é–‹å§‹ç‚ºå…¶é€£æ¥çš„ HART åˆ†é…ä¸€å€‹ HART index</li><li>è©² index ç”¨æ–¼æ¨™è­˜ HARTï¼Œä½†ä¸ä¸€å®šèˆ‡ RISC-V ç‰¹æ¬Šæ¶æ§‹åˆ†é…çš„ HART ID æœ‰é—œ</li></ul></li><li>æ¯å€‹ SSWI è¨­å‚™æœ€å¤šæ”¯æŒ 4095 å€‹ HARTï¼Œå°æ‡‰åˆ° 4095 å€‹ <code>SETSSIP</code> Registers</li></ul><h2 id="register-map-2" tabindex="-1"><a class="header-anchor" href="#register-map-2"><span>Register Map</span></a></h2><p>ACLINT SSWI Device Register Mapï¼š</p><table><thead><tr><th>Offset</th><th>Width</th><th>Attr</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>0x0000_0000</td><td>4B</td><td>RW</td><td>SETSSIP0</td><td>HART index 0 set supervisor-level IPI register</td></tr><tr><td>0x0000_0004</td><td>4B</td><td>RW</td><td>SETSSIP1</td><td>HART index 1 set supervisor-level IPI register</td></tr><tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><td>0x0000_3FFC</td><td>4B</td><td></td><td>RESERVED</td><td>Reserved for future use.</td></tr></tbody></table><ul><li>addresse offset <ul><li>ç¬¬ 0 å€‹ HART çš„ MSIP ä½æ–¼ 0x0000_0000</li><li>ç¬¬ 1 å€‹ HART çš„ MSIP ä½æ–¼ 0x0000_0004</li><li>ä¾æ­¤é¡æ¨ï¼Œæ¯å€‹æš«å­˜å™¨å ç”¨ 4 å­—ç¯€ï¼ˆ32 ä½ï¼‰</li></ul></li><li>åœ°å€ç¯„åœ 0x0000_3FFC ç‚ºä¿ç•™å€åŸŸï¼Œç”¨æ–¼æœªä¾†æ“´å±•</li></ul><h2 id="setssip-registers-offsets-0x00000000-0x00003ff8" tabindex="-1"><a class="header-anchor" href="#setssip-registers-offsets-0x00000000-0x00003ff8"><span>SETSSIP Registers (Offsets: 0x00000000 - 0x00003FF8)</span></a></h2><p>:::spoiler åŸæ–‡</p><blockquote><p>Each <code>SETSSIP</code> register is a 32-bit wide WARL register where the upper 31 bits are wired to zero.</p><p>The least significant bit of a SETSSIP register always reads 0. Writing 0 to the least significant bit of a <code>SETSSIP</code> register has no effect whereas writing 1 to the least significant bit sends an edge-sensitive interrupt signal to the corresponding HART causing the HART to set SSIP in the <code>mip</code> CSR.</p><p>Writes to a <code>SETSSIP</code> register are guaranteed to be reflected in SSIP of the corresponding HART but not necessarily immediately.<br> :::</p></blockquote><ul><li>æ¯å€‹ <code>SETSSIP</code> æš«å­˜å™¨éƒ½æ˜¯ä¸€å€‹ 32 ä½å…ƒå¯¬çš„ WARL æš«å­˜å™¨</li><li>é«˜ 31 ä½ç¡¬æ¥ç·šç‚º 0</li><li>è®€å– <code>SETSSIP</code> æš«å­˜å™¨çš„æœ€ä½æœ‰æ•ˆä½å…ƒå§‹çµ‚è¿”å› <code>0</code></li><li>å°‡ <code>0</code> å¯«å…¥ <code>SETSSIP</code> æš«å­˜å™¨çš„æœ€ä½æœ‰æ•ˆä½å…ƒä¸æœƒç”¢ç”Ÿä»»ä½•å½±éŸ¿</li><li>å°‡ <code>1</code> å¯«å…¥æœ€ä½æœ‰æ•ˆä½å…ƒæœƒå‘å°æ‡‰çš„ HART ç™¼é€ edge-sensitive ä¸­æ–·è¨Šè™Ÿï¼Œå°è‡´ HART åœ¨ <code>mip</code> CSR ä¸­è¨­å®š SSIP</li><li>å° <code>SETSSIP</code> æš«å­˜å™¨çš„å¯«å…¥æ“ä½œä¿è­‰æœƒåæ˜ åœ¨å°æ‡‰ HART çš„ SSIP ä¸­ï¼Œä½†ä¸ä¸€å®šæœƒç«‹å³åæ˜ </li></ul><p>:::spoiler åŸæ–‡</p><blockquote><p><strong>NOTE</strong>: The RISC-V Privileged Architecture defines SSIP in <code>mip</code> and <code>sip</code> CSRs as a <span class="yellow">writeable</span> bit so the M-mode or S-mode software can directly clear SSIP.<br> :::</p></blockquote><ul><li>RISC-V ç‰¹æ¬Šæ¶æ§‹ä¸­å®šç¾© SSIP <code>mip</code> å’Œ <code>sip</code> CSR ä½œç‚ºå¯å¯«ä½ï¼Œå› æ­¤ M mode æˆ– S mode ä¸­è»Ÿé«”å¯ä»¥ç›´æ¥æ¸…é™¤ SSIP</li><li>é»ƒè‰²éƒ¨åˆ†ä¸ç¢ºå®šæ˜¯æ‹¼éŒ¯é‚„æ˜¯æœ‰æ„ç‚ºä¹‹</li></ul></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/Mes0903/Mes0903.github.io/edit/main/src/risc-v/ACLINT/README.md" aria-label="Edit this page" rel="noopener noreferrer" target="_blank" iconsizing="both"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">Last update: </span><span class="vp-meta-info" data-allow-mismatch="text">2/22/2025, 8:43:16 PM</span></div><div class="contributors"><span class="vp-meta-label">Contributors: </span><!--[--><!--[--><span class="vp-meta-info" title="email: mes900903@gmail.com">Mes</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">The content on this site is all CC-BY-SA, or MIT/GPLv3+ dual license for code.</div><div class="vp-copyright">Copyright Â© 2025 Mes </div></footer></div><!--]--><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BcP8o8U4.js" defer></script>
  </body>
</html>
