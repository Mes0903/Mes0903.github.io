<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.19" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.71" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://mes0903.github.io/risc-v/PLIC/"><meta property="og:site_name" content="Mes's Blog"><meta property="og:title" content="RISC-V PLIC"><meta property="og:description" content="RISC-V PLIC specï¼šhttps://github.com/riscv/riscv-plic-spec/blob/master/riscv-plic.adoc Introduction 1. Interrupt Targets and Hart Contexts :::spoiler åŸæ–‡ Interrupt targets are usu..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2025-02-22T19:26:29.000Z"><meta property="article:tag" content="risc-v"><meta property="article:published_time" content="2024-12-13T00:00:00.000Z"><meta property="article:modified_time" content="2025-02-22T19:26:29.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"RISC-V PLIC","image":[""],"datePublished":"2024-12-13T00:00:00.000Z","dateModified":"2025-02-22T19:26:29.000Z","author":[{"@type":"Person","name":"Mes","url":"https://mes0903.github.io"}]}</script><link rel="icon" href="/flame.ico"><title>RISC-V PLIC | Mes's Blog</title><meta name="description" content="RISC-V PLIC specï¼šhttps://github.com/riscv/riscv-plic-spec/blob/master/riscv-plic.adoc Introduction 1. Interrupt Targets and Hart Contexts :::spoiler åŸæ–‡ Interrupt targets are usu...">
    <link rel="preload" href="/assets/style-DW1OEkiQ.css" as="style"><link rel="stylesheet" href="/assets/style-DW1OEkiQ.css">
    <link rel="modulepreload" href="/assets/app-C_w5Vw85.js"><link rel="modulepreload" href="/assets/index.html-BYCMPr_x.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-sKbrm_v2.js" as="script"><link rel="prefetch" href="/assets/index.html-C0CqvOJh.js" as="script"><link rel="prefetch" href="/assets/index.html-Cbrlp1IQ.js" as="script"><link rel="prefetch" href="/assets/index.html-BG5QX-C0.js" as="script"><link rel="prefetch" href="/assets/index.html-Bz9D8lre.js" as="script"><link rel="prefetch" href="/assets/index.html-CLDspNp3.js" as="script"><link rel="prefetch" href="/assets/index.html-QANnzRp0.js" as="script"><link rel="prefetch" href="/assets/index.html-MErq_pGV.js" as="script"><link rel="prefetch" href="/assets/index.html-DgMrs8_U.js" as="script"><link rel="prefetch" href="/assets/index.html-Dvx_NStU.js" as="script"><link rel="prefetch" href="/assets/index.html-VkhoHQaT.js" as="script"><link rel="prefetch" href="/assets/index.html-DrDGUGl-.js" as="script"><link rel="prefetch" href="/assets/index.html-Cb6gdZds.js" as="script"><link rel="prefetch" href="/assets/AboutMovingForward.html-DjDT34zL.js" as="script"><link rel="prefetch" href="/assets/RasterI.html-CJqYqGrn.js" as="script"><link rel="prefetch" href="/assets/index.html-DVTUUd1Y.js" as="script"><link rel="prefetch" href="/assets/index.html-BWyamAKl.js" as="script"><link rel="prefetch" href="/assets/index.html-CdhcC0eN.js" as="script"><link rel="prefetch" href="/assets/index.html-X2OFmK2P.js" as="script"><link rel="prefetch" href="/assets/index.html-CWgAqPs6.js" as="script"><link rel="prefetch" href="/assets/index.html-CDiY4hH1.js" as="script"><link rel="prefetch" href="/assets/index.html-B7qg2pZQ.js" as="script"><link rel="prefetch" href="/assets/index.html-BFm8YfLF.js" as="script"><link rel="prefetch" href="/assets/index.html-C335Ejeh.js" as="script"><link rel="prefetch" href="/assets/index.html-Cbl6R05-.js" as="script"><link rel="prefetch" href="/assets/index.html-BEggqDqx.js" as="script"><link rel="prefetch" href="/assets/index.html-DJIsxwSE.js" as="script"><link rel="prefetch" href="/assets/risc-v_osdi.html-DOUSIUUp.js" as="script"><link rel="prefetch" href="/assets/index.html-CDZlrhK-.js" as="script"><link rel="prefetch" href="/assets/index.html-D4yUHHhK.js" as="script"><link rel="prefetch" href="/assets/index.html-BE_HLNtd.js" as="script"><link rel="prefetch" href="/assets/index.html-DNd-s6LP.js" as="script"><link rel="prefetch" href="/assets/index.html-Bnk9mAeP.js" as="script"><link rel="prefetch" href="/assets/index.html-B4-rQR7X.js" as="script"><link rel="prefetch" href="/assets/index.html-BFTzMyls.js" as="script"><link rel="prefetch" href="/assets/index.html-zADJMCM1.js" as="script"><link rel="prefetch" href="/assets/index.html-CIZSJ4uo.js" as="script"><link rel="prefetch" href="/assets/index.html-DAlrUrhV.js" as="script"><link rel="prefetch" href="/assets/index.html-DMpI1cPW.js" as="script"><link rel="prefetch" href="/assets/index.html-BLm6Q30m.js" as="script"><link rel="prefetch" href="/assets/index.html-CwdQG9MK.js" as="script"><link rel="prefetch" href="/assets/index.html-CeOSU4J3.js" as="script"><link rel="prefetch" href="/assets/index.html-BGQtW2F_.js" as="script"><link rel="prefetch" href="/assets/index.html-Dg0sDH1h.js" as="script"><link rel="prefetch" href="/assets/index.html-Dom0vyl7.js" as="script"><link rel="prefetch" href="/assets/index.html-DonensqQ.js" as="script"><link rel="prefetch" href="/assets/index.html-BXZIVwxs.js" as="script"><link rel="prefetch" href="/assets/404.html-Mgogc9qe.js" as="script"><link rel="prefetch" href="/assets/index.html-pBkSm_0J.js" as="script"><link rel="prefetch" href="/assets/index.html-BKVSHYXj.js" as="script"><link rel="prefetch" href="/assets/index.html-DzoENMcl.js" as="script"><link rel="prefetch" href="/assets/index.html-DD5sE_4m.js" as="script"><link rel="prefetch" href="/assets/index.html-CjQz93-n.js" as="script"><link rel="prefetch" href="/assets/index.html-BZMww6Ae.js" as="script"><link rel="prefetch" href="/assets/index.html-CCndNtP1.js" as="script"><link rel="prefetch" href="/assets/index.html-Dgip5iAA.js" as="script"><link rel="prefetch" href="/assets/index.html-CVPnQ6Jq.js" as="script"><link rel="prefetch" href="/assets/index.html-Qmp7mJaw.js" as="script"><link rel="prefetch" href="/assets/index.html-8heulvDG.js" as="script"><link rel="prefetch" href="/assets/index.html-B9pHlrHv.js" as="script"><link rel="prefetch" href="/assets/index.html-mF4mg8oi.js" as="script"><link rel="prefetch" href="/assets/index.html-Cl4r-GRx.js" as="script"><link rel="prefetch" href="/assets/index.html-BHcW2i8O.js" as="script"><link rel="prefetch" href="/assets/index.html-Bkk2H9Cn.js" as="script"><link rel="prefetch" href="/assets/index.html-6SKTm4et.js" as="script"><link rel="prefetch" href="/assets/index.html-qMDJCyO5.js" as="script"><link rel="prefetch" href="/assets/index.html-G_BD7FOq.js" as="script"><link rel="prefetch" href="/assets/index.html-CTzlB-v3.js" as="script"><link rel="prefetch" href="/assets/index.html-DEEDndO1.js" as="script"><link rel="prefetch" href="/assets/index.html-D9BS3UQG.js" as="script"><link rel="prefetch" href="/assets/index.html-CfsgFuaM.js" as="script"><link rel="prefetch" href="/assets/index.html-Dq2rMlPw.js" as="script"><link rel="prefetch" href="/assets/index.html-CH_JK30y.js" as="script"><link rel="prefetch" href="/assets/index.html-DsxhqK6k.js" as="script"><link rel="prefetch" href="/assets/index.html-IPkjVg9f.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-DXWKOczD.js" as="script"><link rel="prefetch" href="/assets/index-B-M8YVCw.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-kNMJJy86.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><!--[--><div class="theme-container no-sidebar external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="Take me home"><img class="vp-nav-logo" src="/flame.jpg" alt><!----><span class="vp-site-name hide-in-pad">Mes&#39;s Blog</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!----><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->RISC-V PLIC</h1><div class="page-info"><span class="page-author-info" aria-label="AuthorğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mes0903.github.io" target="_blank" rel="noopener noreferrer">Mes</a></span><span property="author" content="Mes"></span></span><!----><span class="page-date-info" aria-label="Writing DateğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">December 13, 2024</span><meta property="datePublished" content="2024-12-13T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 12 min</span><meta property="timeRequired" content="PT12M"></span><span class="page-category-info" aria-label="CategoryğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color8 clickable" role="navigation">risc-v</span><!--]--><meta property="articleSection" content="risc-v"></span><span class="page-tag-info" aria-label="TagğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color8 clickable" role="navigation">risc-v</span><!--]--><meta property="keywords" content="risc-v"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><!--[--><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-interrupt-targets-and-hart-contexts">1. Interrupt Targets and Hart Contexts</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-interrupt-gateways-ä¸­æ–·é–˜é“">2. Interrupt Gateways ï¼ˆä¸­æ–·é–˜é“ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-interrupt-notifications-3-ä¸­æ–·é€šçŸ¥">3. Interrupt Notifications 3. ä¸­æ–·é€šçŸ¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-interrupt-identifiers-ids">4. Interrupt Identifiers (IDs)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5-interrupt-flow-ä¸­æ–·æµç¨‹">5. Interrupt Flow ï¼ˆä¸­æ–·æµç¨‹ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-risc-v-plic-operation-parameters">1. RISC-V PLIC Operation Parameters</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-memory-map">2. Memory Map</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-interrupt-priorities">3. Interrupt Priorities</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-interrupt-pending-bits">4. Interrupt Pending Bits</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5-interrupt-enables">5. Interrupt Enables</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_6-priority-thresholds">6. Priority Thresholds</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_7-interrupt-claim-process">7. Interrupt Claim Process</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_8-interrupt-completion">8. Interrupt Completion</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--]--><!----></aside></div><!----><div class="theme-hope-content" vp-content><h1 id="risc-v-plic" tabindex="-1"><a class="header-anchor" href="#risc-v-plic"><span>RISC-V PLIC</span></a></h1><ul><li>specï¼š<a href="https://github.com/riscv/riscv-plic-spec/blob/master/riscv-plic.adoc" target="_blank" rel="noopener noreferrer">https://github.com/riscv/riscv-plic-spec/blob/master/riscv-plic.adoc</a></li></ul><h1 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"><span>Introduction</span></a></h1><h2 id="_1-interrupt-targets-and-hart-contexts" tabindex="-1"><a class="header-anchor" href="#_1-interrupt-targets-and-hart-contexts"><span>1. Interrupt Targets and Hart Contexts</span></a></h2><p>:::spoiler åŸæ–‡</p><p>Interrupt targets are usually hart contexts, where a hart context is a given privilege mode on a given hart (though there are other possible interrupt targets, such as DMA engines). For example, in an 4-core system with 2-way SMT, you have 8 harts and probably at least two privilege modes per hart: machine mode and supervisor mode (Ref).</p><p>:::</p><p>æ‰€è¬‚çš„ hart context æ˜¯æŒ‡åœ¨ä¸€å€‹çµ¦å®šçš„ hart ä¸Šçš„ç‰¹æ¬Šæ¨¡å¼ï¼Œè€Œåœ¨ RISC-V å…§ï¼Œä¸­æ–·ç›®æ¨™é€šå¸¸æ˜¯ hart contextï¼Œä¹Ÿå°±æ˜¯èªªæ˜¯ä»¥ hart + ç‰¹æ¬Šæ¨¡å¼ç‚ºç›®æ¨™åœ¨åŸ·è¡Œä¸­æ–·çš„ï¼Œæ¯å€‹ hart åœ¨æ¯å€‹ç‰¹æ¬Šæ¨¡å¼ä¸‹éƒ½æœ‰ä¸€å€‹ç¨ç«‹çš„ hart context</p><p>åœ¨ä¸€å€‹ 2-way SMT çš„ 4-core ç³»çµ±ä¸­ï¼Œæ¯å€‹ core å¯ä»¥åŒæ™‚åŸ·è¡Œå…©å€‹ç¡¬é«”åŸ·è¡Œç·’ï¼Œå› æ­¤æˆ‘å€‘æœ‰ 8 å€‹ hartsï¼Œæ¯å€‹ hart å¯èƒ½è‡³å°‘æœ‰ M mode èˆ‡ S mode é€™å…©å€‹ç‰¹æ¬Šæ¨¡å¼ï¼Œå› æ­¤å…±æœ‰ 8x2 = 16 å€‹ hart context</p><p>:::spoiler åŸæ–‡</p><p>Not all hart contexts need be interrupt targets, in particular, if a processor core does not support delegating external interrupts to lower-privilege modes, then the lower-privilege hart contexts will not be interrupt targets. Interrupt notifications generated by the PLIC appear in the meip/seip bits of the mip/sip registers for M/S modes respectively.</p><p>The notification only appear in lower-privilege xip registers if external interrupts have been delegated to the lower-privilege modes.</p><p>:::</p><p>ä¸¦éæ‰€æœ‰çš„ hart context éƒ½ã€Œéœ€è¦ã€æ˜¯ä¸­æ–·ç›®æ¨™ï¼Œç‰¹åˆ¥æ˜¯å¦‚æœè™•ç†å™¨æ ¸å¿ƒä¸æ”¯æ´å°‡å¤–éƒ¨ä¸­æ–·ä»£ç†ï¼ˆdelegateï¼‰çµ¦è¼ƒä½çš„ç‰¹æ¬Šæ¨¡å¼æ™‚ï¼Œæ­¤æ™‚è¼ƒä½ç‰¹æ¬Šæ¨¡å¼çš„ hart context å°±ä¸æœƒæ˜¯ä¸­æ–·ç›®æ¨™</p><p>PLIC ç”¢ç”Ÿçš„ä¸­æ–·é€šçŸ¥ï¼ˆInterrupt notificationsï¼‰æœƒåˆ†åˆ¥å‡ºç¾åœ¨ M/S mode ä¸‹çš„ <code>mip</code>/<code>sip</code> æš«å­˜å™¨ä¸­çš„ <code>meip</code>/<code>seop</code> bits</p><p>å¦‚æœå¤–éƒ¨ä¸­æ–·å·²è¢«ä»£ç†çµ¦è¼ƒä½çš„ç‰¹æ¬Šæ¨¡å¼ï¼Œå‰‡è©²ä¸­æ–·é€šçŸ¥åªæœƒå‡ºç¾åœ¨è¼ƒä½æ¬Šé™çš„ xip æš«å­˜å™¨ä¸­</p><p>:::spoiler åŸæ–‡</p><p>Previous versions of this specification indicated that the PLIC supports U-mode interrupts. This text was removed because the privileged architecture does not define U-mode interrupts. If a future privileged architecture specifies U-mode interrupts, this PLIC specification can be straightforwardly extended to support them.</p><p>:::</p><p>èˆŠç‰ˆæœ¬çš„ spec è¡¨æ˜ PLIC æ”¯æ´ U mode ä¸­æ–·ï¼Œè©²ç‰‡æ®µå·²è¢«åˆªé™¤ï¼Œå› ç‚ºç‰¹æ¬Šæ¶æ§‹æœªå®šç¾© U æ¨¡å¼ä¸­æ–·ã€‚ å¦‚æœæœªä¾†çš„ç‰¹æ¬Šæ¶æ§‹æŒ‡å®šäº† U æ¨¡å¼ä¸­æ–·ï¼Œå‰‡å¯ä»¥ç›´æ¥æ“´å±•æ­¤ PLIC è¦ç¯„ä»¥æ”¯æ´å®ƒå€‘</p><p>:::spoiler åŸæ–‡</p><p>Each processor core must define a policy on how simultaneous active interrupts are taken by multiple hart contexts on the core. For the simple case of a single stack of hart contexts, one for each supported privileged mode, interrupts for higher-privilege contexts can preempt execution of interrupt handlers for lower-privilege contexts. A multithreaded processor core could run multiple independent interrupt handlers on different hart contexts at the same time. A processor core could also provide hart contexts that are only used for interrupt handling to reduce interrupt service latency, and these might preempt interrupt handlers for other harts on the same core.</p><p>:::</p><p>æ¯å€‹è™•ç†å™¨æ ¸å¿ƒå¿…é ˆå®šç¾©å¤šå€‹ hart context åŒæ™‚ç™¼èµ·ä¸­æ–·æ™‚è©²å¦‚ä½•è™•ç†ã€‚ åœ¨åªæœ‰ä¸€å€‹ hart çš„æƒ…æ³ä¸‹ï¼Œæ¯å€‹ hart contexts å„æœ‰ä¸€å€‹ stackï¼Œåœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œé«˜ç‰¹æ¬Šæ¨¡å¼çš„ä¸­æ–·å¯ä»¥æ¶å ï¼ˆpreemptï¼‰ä½ç‰¹æ¬Šæ¨¡å¼çš„ä¸­æ–·è™•ç†ç¨‹åºï¼ˆInterrupt Handlerï¼‰</p><p>è€Œå°æ–¼å¤šåŸ·è¡Œç·’çš„è™•ç†å™¨æ ¸å¿ƒï¼Œå¯ä»¥åœ¨ä¸åŒçš„ hart context ä¸ŠåŒæ™‚é‹è¡Œå¤šå€‹ç¨ç«‹çš„ä¸­æ–·è™•ç†ç¨‹åºã€‚ æ­¤å¤–ï¼Œè™•ç†å™¨æ ¸å¿ƒé‚„å¯ä»¥æä¾›å°ˆé–€ç”¨æ–¼ä¸­æ–·è™•ç†çš„ hart contextï¼Œä»¥é™ä½ä¸­æ–·æœå‹™å»¶é²ï¼ˆinterrupt service latencyï¼‰ï¼Œé€™äº›å°ˆç”¨çš„ hart context å¯èƒ½æœƒæ¶å åŒä¸€æ ¸å¿ƒä¸Šå…¶ä»– hart çš„ä¸­æ–·è™•ç†ç¨‹åº</p><p>:::spoiler åŸæ–‡</p><p>The PLIC treats each interrupt target independently and does not take into account any interrupt prioritization scheme used by a component that contains multiple interrupt targets. As a result, the PLIC provides no concept of interrupt preemption or nesting so this must be handled by the cores hosting multiple interrupt target contexts.</p><p>:::</p><p>PLIC æœƒç¨ç«‹è™•ç†æ¯å€‹ä¸­æ–·ç›®æ¨™ï¼Œä¸æœƒè€ƒæ…®ä¸åŒä¸­æ–·ç›®æ¨™çš„å…ƒä»¶å…§æ‰€ä½¿ç”¨çš„ä»»ä½•ä¸­æ–·å„ªå…ˆç´šï¼ˆinterrupt prioritizationï¼‰ã€‚ å› æ­¤ PLIC ä¸æä¾›ä¸­æ–·æ¶å æˆ–åµŒå¥—ï¼ˆnestingï¼‰çš„æ¦‚å¿µï¼Œé€™è¦ç”±æ‰¿è¼‰å¤šå€‹ä¸­æ–·ç›®æ¨™çš„è™•ç†å™¨æ ¸å¿ƒä¾†è™•ç†</p><!----><h2 id="_2-interrupt-gateways-ä¸­æ–·é–˜é“" tabindex="-1"><a class="header-anchor" href="#_2-interrupt-gateways-ä¸­æ–·é–˜é“"><span>2. Interrupt Gateways ï¼ˆä¸­æ–·é–˜é“ï¼‰</span></a></h2><p>:::spoiler åŸæ–‡</p><p>The interrupt gateways are responsible for converting global interrupt signals into a common interrupt request format, and for controlling the flow of interrupt requests to the PLIC core. At most one interrupt request per interrupt source can be pending in the PLIC core at any time, indicated by setting the sourceâ€™s IP bit. The gateway only forwards a new interrupt request to the PLIC core after receiving notification that the interrupt handler servicing the previous interrupt request from the same source has completed.</p><p>:::</p><p>ä¸­æ–·é–˜é“è² è²¬å°‡å…¨åŸŸçš„ä¸­æ–·ä¿¡è™Ÿï¼ˆglobal interrupt signalsï¼‰è½‰æ›ç‚ºé€šç”¨çš„ä¸­æ–·è«‹æ±‚æ ¼å¼ï¼Œä¸¦å°‡ä¸­æ–·è«‹æ±‚è½‰é€çµ¦ PLIC æ ¸å¿ƒã€‚ æ¯å€‹ä¸­æ–·æºï¼ˆinterrupt sourceï¼‰æœ€å¤šåªèƒ½åœ¨ PLIC æ ¸å¿ƒä¸­æœ‰ä¸€å€‹å¾…è™•ç†çš„ä¸­æ–·è«‹æ±‚ï¼Œé€™æ˜¯é€šéè¨­ç½®è©²ä¸­æ–·æºçš„ IP ä½ä¾†æŒ‡ç¤ºçš„ã€‚ ç•¶ä¸­æ–·è™•ç†ç¨‹åºå®Œæˆå…ˆå‰çš„ä¸­æ–·è«‹æ±‚æ™‚ï¼Œæœƒå›é€ä¸€å€‹é€šçŸ¥ï¼ˆå°±æ˜¯ç¨® ackï¼‰ï¼Œé–˜é“åœ¨æ”¶åˆ°é€šçŸ¥å¾Œæ‰æœƒå°‡æ–°çš„ä¸­æ–·è«‹æ±‚è½‰ç™¼çµ¦ PLIC æ ¸å¿ƒ</p><p>:::spoiler åŸæ–‡</p><p>If the global interrupt source uses level-sensitive interrupts, the gateway will convert the first assertion of the interrupt level into an interrupt request, but thereafter the gateway will not forward an additional interrupt request until it receives an interrupt completion message. On receiving an interrupt completion message, if the interrupt is level-triggered and the interrupt is still asserted, a new interrupt request will be forwarded to the PLIC core. The gateway does not have the facility to retract an interrupt request once forwarded to the PLIC core. If a level-sensitive interrupt source deasserts the interrupt after the PLIC core accepts the request and before the interrupt is serviced, the interrupt request remains present in the IP bit of the PLIC core and will be serviced by a handler, which will then have to determine that the interrupt device no longer requires service.</p><p>:::</p><p>å¦‚æœå…¨åŸŸä¸­æ–·ä¾†æºä½¿ç”¨çš„æ˜¯é›»å¹³è§¸ç™¼ï¼ˆlevel-sensitiveï¼‰çš„ä¸­æ–·ï¼Œé–˜é“æœƒå°‡ç¬¬ä¸€æ¬¡è§¸ç™¼çš„ä¸­æ–·è¨Šè™Ÿè½‰æ›æˆä¸­æ–·è«‹æ±‚ï¼Œä¹‹å¾Œç›´åˆ°æ”¶åˆ°ä¸­æ–·å®Œæˆè¨Šæ¯ï¼ˆinterrupt completion messageï¼‰å‰éƒ½ä¸æœƒå†è½‰ç™¼é¡å¤–çš„ä¸­æ–·è«‹æ±‚ã€‚ ç•¶æ”¶åˆ°ä¸­æ–·å®Œæˆè¨Šæ¯æ™‚ï¼Œå¦‚æœè©²ä¸­æ–·æ˜¯é›»å¹³è§¸ç™¼ä¸”ä¸­æ–·è¨Šè™Ÿä»ç„¶ä¿æŒè§¸ç™¼ç‹€æ…‹ï¼Œå‰‡æœƒå°‡æ–°çš„ä¸­æ–·è«‹æ±‚è½‰ç™¼çµ¦ PLIC æ ¸å¿ƒ</p><p>é–˜é“ç„¡æ³•åœ¨ä¸­æ–·è«‹æ±‚å·²ç¶“è¢«è½‰ç™¼åˆ° PLIC æ ¸å¿ƒå¾Œæ’¤å›è©²è«‹æ±‚ã€‚ å¦‚æœé›»å¹³è§¸ç™¼çš„ä¸­æ–·ä¾†æºåœ¨ PLIC æ ¸å¿ƒæ¥å—äº†è«‹æ±‚ï¼Œä¸”ä¸­æ–·å°šæœªè¢«è™•ç†ä¹‹å‰å–æ¶ˆäº†ä¸­æ–·ï¼ˆdeassertsï¼‰ï¼Œè©²ä¸­æ–·è«‹æ±‚ä»ç„¶æœƒä¿ç•™åœ¨ PLIC æ ¸å¿ƒçš„ IP ä½å…ƒä¸­ï¼Œä¸¦æœ€çµ‚ç”±ä¸­æ–·è™•ç†ç¨‹åºè™•ç†ï¼Œæ­¤æ™‚ä¸­æ–·è™•ç†ç¨‹åºéœ€è‡ªè¡Œåˆ¤å®šè©²ä¸­æ–·è¨­å‚™æ˜¯å¦ä»éœ€è¦è™•ç†</p><p>:::spoiler åŸæ–‡</p><p>If the global interrupt source was edge-triggered, the gateway will convert the first matching signal edge into an interrupt request. Depending on the design of the device and the interrupt handler, in between sending an interrupt request and receiving notice of its handlerâ€™s completion, the gateway might either ignore additional matching edges or increment a counter of pending interrupts. In either case, the next interrupt request will not be forwarded to the PLIC core until the previous completion message has been received. If the gateway has a pending interrupt counter, the counter will be decremented when the interrupt request is accepted by the PLIC core. Unlike dedicated-wire interrupt signals, message-signalled interrupts (MSIs) are sent over the system interconnect via a message packet that describes which interrupt is being asserted. The message is decoded to select an interrupt gateway, and the relevant gateway then handles the MSI similar to an edge-triggered interrupt.</p><p>:::</p><p>å¦‚æœå…¨åŸŸä¸­æ–·ä¾†æºæ˜¯é‚Šç·£è§¸ç™¼ï¼ˆedge-triggeredï¼‰çš„ä¸­æ–·ï¼Œé–˜é“æœƒå°‡é¦–æ¬¡ç¬¦åˆçš„è¨Šè™Ÿé‚Šç·£è½‰æ›ç‚ºä¸­æ–·è«‹æ±‚ã€‚ æ ¹æ“šè¨­å‚™å’Œä¸­æ–·è™•ç†ç¨‹åºçš„è¨­è¨ˆï¼Œåœ¨ç™¼é€ä¸­æ–·è«‹æ±‚èˆ‡æ¥æ”¶åˆ°å…¶ä¸­æ–·å®Œæˆé€šçŸ¥ä¹‹é–“ï¼Œé–˜é“å¯èƒ½æœƒå¿½ç•¥é¡å¤–çš„ç¬¦åˆé‚Šç·£ï¼Œæˆ–è€…æœƒå°‡å…¶è¨ˆå…¥å¾…è™•ç†ä¸­æ–·çš„è¨ˆæ•¸å™¨ä¸­</p><p>ä¸è«–æ˜¯å“ªç¨®æƒ…æ³ï¼Œåœ¨ä¸Šä¸€å€‹å®Œæˆé€šçŸ¥è¢«æ¥æ”¶åˆ°ä¹‹å‰ï¼Œä¸‹ä¸€å€‹ä¸­æ–·è«‹æ±‚éƒ½ä¸æœƒè¢«è½‰ç™¼åˆ° PLIC æ ¸å¿ƒã€‚ å¦‚æœé–˜é“å…·æœ‰å¾…è™•ç†ä¸­æ–·è¨ˆæ•¸å™¨ï¼Œç•¶ä¸­æ–·è«‹æ±‚è¢« PLIC æ ¸å¿ƒæ¥å—æ™‚ï¼Œè¨ˆæ•¸å™¨æœƒéæ¸›ã€‚</p><p>èˆ‡å°ˆç”¨ç·šä¸­æ–·è¨Šè™Ÿï¼ˆdedicated-wire interrupt signalsï¼‰ä¸åŒï¼Œè¨Šæ¯ä¿¡è™Ÿä¸­æ–·ï¼ˆMessage-Signalled Interrupts, MSIsï¼‰æ˜¯é€šéç³»çµ±äº’è¯ï¼ˆinterconnectï¼‰ä»¥æè¿°ä¸­æ–·çš„è¨Šæ¯å°åŒ…å½¢å¼å‚³é€çš„ã€‚è¨Šæ¯æœƒè¢«è§£ç¢¼ä»¥é¸æ“‡å°æ‡‰çš„ä¸­æ–·é–˜é“ï¼Œè€Œç›¸é—œçš„é–˜é“æœƒä»¥é¡ä¼¼é‚Šç·£è§¸ç™¼ä¸­æ–·çš„æ–¹å¼è™•ç† MSI</p><h2 id="_3-interrupt-notifications-3-ä¸­æ–·é€šçŸ¥" tabindex="-1"><a class="header-anchor" href="#_3-interrupt-notifications-3-ä¸­æ–·é€šçŸ¥"><span>3. Interrupt Notifications 3. ä¸­æ–·é€šçŸ¥</span></a></h2><p>:::spoiler åŸæ–‡</p><p>Each interrupt target has an external interrupt pending (EIP) bit in the PLIC core that indicates that the corresponding target has a pending interrupt waiting for service. The value in EIP can change as a result of changes to state in the PLIC core, brought on by interrupt sources, interrupt targets, or other agents manipulating register values in the PLIC. The value in EIP is communicated to the destination target as an interrupt notification. If the target is a RISC-V hart context, the interrupt notifications arrive on the meip/seip bits depending on the privilege level of the hart context.</p><p>(In simple systems, the interrupt notifications will be simple wires connected to the processor implementing a hart. In more complex platforms, the notifications might be routed as messages across a system interconnect.)</p><p>:::</p><p>æ¯å€‹ä¸­æ–·ç›®æ¨™åœ¨ PLIC æ ¸å¿ƒä¸­éƒ½æœ‰ä¸€å€‹å°æ‡‰çš„å¤–éƒ¨ä¸­æ–·æ›èµ·ä½å…ƒï¼ˆExternal Interrupt Pending, EIPï¼‰ï¼Œè©²ä½å…ƒè¡¨ç¤ºå°æ‡‰çš„ç›®æ¨™æœ‰ä¸€å€‹æ›èµ·çš„ä¸­æ–·ç­‰å¾…è™•ç†ã€‚ EIP çš„å€¼å¯èƒ½æœƒå›  PLIC æ ¸å¿ƒç‹€æ…‹çš„è®ŠåŒ–è€Œæ”¹è®Šï¼Œé€™äº›è®ŠåŒ–å¯èƒ½ç”±ä¸­æ–·ä¾†æºã€ä¸­æ–·ç›®æ¨™ï¼Œæˆ–è€…å…¶ä»–ä¿®æ”¹ PLIC ä¸­æš«å­˜å™¨å€¼çš„ agent å¼•èµ·</p><p>EIP çš„å€¼æœƒä½œç‚ºä¸­æ–·é€šçŸ¥å‚³é€çµ¦ç›®æ¨™ï¼Œå¦‚æœç›®æ¨™æ˜¯ä¸€å€‹ RISC-V çš„ hart contextï¼Œä¸­æ–·é€šçŸ¥æœƒæ ¹æ“š hart context çš„ç‰¹æ¬Šå±¤ç´šï¼Œå‚³é€åˆ° meip æˆ– seip ä½å…ƒä¸Š</p><p>åœ¨ç°¡å–®çš„ç³»çµ±ä¸­ï¼Œä¸­æ–·é€šçŸ¥é€šå¸¸æ˜¯ç›´æ¥é€£æ¥åˆ°å¯¦ç¾ hart çš„è™•ç†å™¨çš„ç°¡å–®è¨Šè™Ÿç·šã€‚ åœ¨æ›´è¤‡é›œçš„å¹³å°ä¸­ï¼Œä¸­æ–·é€šçŸ¥å¯èƒ½æœƒä»¥æ¶ˆæ¯çš„å½¢å¼é€šéç³»çµ±å…§éƒ¨çš„è·¯ç”±å‚³é€</p><p>:::spoiler åŸæ–‡</p><p>The PLIC hardware only supports multicasting of interrupts, such that all enabled targets will receive interrupt notifications for a given active interrupt.</p><p>(Multicasting provides rapid response since the fastest responder claims the interrupt, but can be wasteful in high-interrupt-rate scenarios if multiple harts take a trap for an interrupt that only one can successfully claim. Software can modulate the PLIC IE bits as part of each interrupt handler to provide alternate policies, such as interrupt affinity or round-robin unicasting.)</p><p>:::</p><p>PLIC ç¡¬é«”åƒ…æ”¯æ´ä¸­æ–·çš„å¤šæ’­ï¼ˆmulticastingï¼‰ï¼Œå³æ‰€æœ‰å•Ÿç”¨çš„ç›®æ¨™éƒ½æœƒæ”¶åˆ°å°æ–¼ç‰¹å®šæ´»èºä¸­æ–·çš„é€šçŸ¥</p><p>å¤šæ’­å¯ä»¥åŠ é€ŸéŸ¿æ‡‰é€Ÿåº¦ï¼Œå› ç‚ºæœ€å¿«çš„éŸ¿æ‡‰è€…æœƒèªé ˜è©²ä¸­æ–·ï¼Œä½†åœ¨é«˜ä¸­æ–·ç‡çš„æƒ…å¢ƒä¸‹å¯èƒ½æœƒé€ æˆæµªè²»ï¼Œå› ç‚ºå¤šå€‹ harts å¯èƒ½æœƒç‚ºåƒ…èƒ½è¢«å…¶ä¸­ä¸€å€‹æˆåŠŸèªé ˜çš„ä¸­æ–·é™·å…¥ä¸­æ–·è™•ç†ç¨‹åºã€‚ è»Ÿé«”å¯ä»¥åœ¨æ¯å€‹ä¸­æ–·è™•ç†ç¨‹åºä¸­èª¿æ•´ PLIC çš„ IE ä½å…ƒï¼Œå¯¦ç¾å…¶ä»–çš„æ›¿ä»£ç­–ç•¥ï¼Œä¾‹å¦‚ä¸­æ–·è¦ªå’Œæ€§ï¼ˆinterrupt affinityï¼‰æˆ– round-robin unicasting</p><p>:::spoiler åŸæ–‡</p><p>Depending on the platform architecture and the method used to transport interrupt notifications, these might take some time to be received at the targets. The PLIC is guaranteed to eventually deliver all state changes in EIP to all targets, provided there is no intervening activity in the PLIC core.</p><p>(The value in an interrupt notification is only guaranteed to hold an EIP value that was valid at some point in the past. In particular, a second target can respond and claim an interrupt while a notification to the first target is still in flight, such that when the first target tries to claim the interrupt it finds it has no active interrupts in the PLIC core.)</p><p>:::</p><p>æ ¹æ“šå¹³å°æ¶æ§‹å’Œç”¨æ–¼å‚³è¼¸ä¸­æ–·é€šçŸ¥çš„æ–¹æ³•ï¼Œé€™äº›ä¸­æ–·é€šçŸ¥å¯èƒ½éœ€è¦ä¸€äº›æ™‚é–“æ‰èƒ½åˆ°é”ç›®æ¨™ã€‚ å¦‚æœ PLIC æ ¸å¿ƒä¸­æ²’æœ‰å…¶ä»–å¹²æ“¾æ´»å‹•ï¼Œå‰‡ PLIC ä¿è­‰æœ€çµ‚æœƒå°‡ EIP çš„æ‰€æœ‰ç‹€æ…‹è®Šæ›´å‚³éçµ¦æ‰€æœ‰ç›®æ¨™</p><p>ä¸­æ–·é€šçŸ¥ä¸­çš„å€¼åƒ…ä¿è­‰è¡¨ç¤ºæŸå€‹éå»æ™‚åˆ»çš„æœ‰æ•ˆ EIP å€¼ï¼Œç‰¹åˆ¥æ˜¯ç•¶ç¬¬ä¸€å€‹ç›®æ¨™çš„ä¸­æ–·é€šçŸ¥å°šæœªåˆ°é”æ™‚ï¼Œå¦ä¸€å€‹ç›®æ¨™å¯èƒ½å·²ç¶“éŸ¿æ‡‰ä¸¦èªé ˜äº†è©²ä¸­æ–·ï¼Œé€™æœƒå°è‡´ç•¶ç¬¬ä¸€å€‹ç›®æ¨™å˜—è©¦èªé ˜ä¸­æ–·æ™‚ï¼Œç™¼ç¾ PLIC æ ¸å¿ƒä¸­å·²æ²’æœ‰æ´»èºçš„ä¸­æ–·</p><h2 id="_4-interrupt-identifiers-ids" tabindex="-1"><a class="header-anchor" href="#_4-interrupt-identifiers-ids"><span>4. Interrupt Identifiers (IDs)</span></a></h2><p>:::spoiler åŸæ–‡</p><p>Global interrupt sources are assigned small unsigned integer identifiers, beginning at the value 1. An interrupt ID of 0 is reserved to mean â€œno interruptâ€.</p><p>Interrupt identifiers are also used to break ties when two or more interrupt sources have the same assigned priority. Smaller values of interrupt ID take precedence over larger values of interrupt ID.</p><p>:::</p><p>æ¯å€‹å…¨åŸŸä¸­æ–·ä¾†æºæœƒè¢«åˆ†é…åˆ°ä¸€å€‹å°çš„ unsigned integer ä½œç‚ºè­˜åˆ¥ç¢¼ï¼Œå€¼å¾ 1 é–‹å§‹ï¼Œè­˜åˆ¥ç¢¼ 0 è¢«ä¿ç•™ç”¨ä¾†è¡¨ç¤ºã€Œç„¡ä¸­æ–·ã€ã€‚ å¦å¤–ï¼Œåœ¨å…©å€‹æˆ–å¤šå€‹ä¸­æ–·ä¾†æºå…·æœ‰ç›¸åŒå„ªå…ˆç´šæ™‚ï¼Œå°çš„ IDs æœƒæ¯”å¤§çš„ IDs æœ‰è¼ƒé«˜çš„å„ªå…ˆæ¬Š</p><h2 id="_5-interrupt-flow-ä¸­æ–·æµç¨‹" tabindex="-1"><a class="header-anchor" href="#_5-interrupt-flow-ä¸­æ–·æµç¨‹"><span>5. Interrupt Flow ï¼ˆä¸­æ–·æµç¨‹ï¼‰</span></a></h2><p>:::spoiler åŸæ–‡</p><p>Below figure shows the messages flowing between agents when handling interrupts via the PLIC.</p><ul><li>Global interrupts are sent from their source to an interrupt gateway that processes the interrupt signal from each source</li><li>Interrupt gateway then sends a single interrupt request to the PLIC core, which latches these in the core interrupt pending bits (IP).</li><li>The PLIC core forwards an interrupt notification to one or more targets if the targets have any pending interrupts enabled, and the priority of the pending interrupts exceeds a per-target threshold.</li><li>When the target takes the external interrupt, it sends an interrupt claim request to retrieve the identifier of the highest priority global interrupt source pending for that target from the PLIC core.</li><li>PLIC core then clears the corresponding interrupt source pending bit.</li><li>After the target has serviced the interrupt, it sends the associated interrupt gateway an interrupt completion message</li><li>The interrupt gateway can now forward another interrupt request for the same source to the PLIC.</li></ul><p>:::</p><p>ä¸‹åœ–é¡¯ç¤ºäº†åœ¨é€šé PLIC è™•ç†ä¸­æ–·æ™‚ï¼Œagent ä¹‹é–“æµå‹•çš„æ¶ˆæ¯</p><ul><li>å…¨åŸŸä¸­æ–·å¾å…¶ä¾†æºç™¼é€åˆ°ä¸­æ–·é–˜é“ï¼Œè©²é–˜é“è² è²¬è™•ç†æ¯å€‹ä¾†æºçš„ä¸­æ–·ä¿¡è™Ÿ</li><li>ä¸­æ–·é–˜é“éš¨å¾Œå‘ PLIC æ ¸å¿ƒç™¼é€å–®ä¸€çš„ä¸­æ–·è«‹æ±‚ï¼Œé€™äº›è«‹æ±‚æœƒåœ¨æ ¸å¿ƒçš„ä¸­æ–·æ›èµ·ä½å…ƒï¼ˆinterrupt pending bits, IPï¼‰ä¸­é–å­˜ï¼ˆlatchesï¼‰</li><li>å¦‚æœç›®æ¨™æœ‰å•Ÿç”¨æ›èµ·çš„ä¸­æ–·ï¼Œä¸”æ›èµ·ä¸­æ–·çš„å„ªå…ˆç´šè¶…éæ¯å€‹ç›®æ¨™çš„é–¾å€¼ï¼Œå‰‡ PLIC æ ¸å¿ƒæœƒå°‡ä¸­æ–·é€šçŸ¥è½‰ç™¼çµ¦ä¸€å€‹æˆ–å¤šå€‹ç›®æ¨™</li><li>ç•¶ç›®æ¨™æ¥æ”¶åˆ°å¤–éƒ¨ä¸­æ–·å¾Œï¼Œå®ƒæœƒå‘ PLIC æ ¸å¿ƒç™¼é€ä¸­æ–·è«‹æ±‚ï¼Œä»¥æª¢ç´¢é‡å°è©²ç›®æ¨™çš„æœ€é«˜å„ªå…ˆç´šå…¨åŸŸä¸­æ–·ä¾†æºçš„è­˜åˆ¥ç¢¼</li><li>PLIC æ ¸å¿ƒéš¨å¾Œæ¸…é™¤ç›¸æ‡‰çš„ä¸­æ–·ä¾†æºæ›èµ·ä½å…ƒï¼ˆinterrupt source pending bitï¼‰</li><li>åœ¨ç›®æ¨™è™•ç†å®Œè©²ä¸­æ–·å¾Œï¼Œæœƒå‘ç›¸é—œçš„ä¸­æ–·é–˜é“ç™¼é€ä¸­æ–·å®Œæˆæ¶ˆæ¯</li><li>ä¹‹å¾Œä¸­æ–·é–˜é“ä¾¿å¯ä»¥å†ç‚ºç›¸åŒçš„ä¾†æºå‘ PLIC è½‰ç™¼å¦ä¸€å€‹ä¸­æ–·è«‹æ±‚äº†</li></ul><!----><h1 id="details" tabindex="-1"><a class="header-anchor" href="#details"><span>Details</span></a></h1><h2 id="_1-risc-v-plic-operation-parameters" tabindex="-1"><a class="header-anchor" href="#_1-risc-v-plic-operation-parameters"><span>1. RISC-V PLIC Operation Parameters</span></a></h2><h2 id="_2-memory-map" tabindex="-1"><a class="header-anchor" href="#_2-memory-map"><span>2. Memory Map</span></a></h2><h2 id="_3-interrupt-priorities" tabindex="-1"><a class="header-anchor" href="#_3-interrupt-priorities"><span>3. Interrupt Priorities</span></a></h2><h2 id="_4-interrupt-pending-bits" tabindex="-1"><a class="header-anchor" href="#_4-interrupt-pending-bits"><span>4. Interrupt Pending Bits</span></a></h2><h2 id="_5-interrupt-enables" tabindex="-1"><a class="header-anchor" href="#_5-interrupt-enables"><span>5. Interrupt Enables</span></a></h2><h2 id="_6-priority-thresholds" tabindex="-1"><a class="header-anchor" href="#_6-priority-thresholds"><span>6. Priority Thresholds</span></a></h2><h2 id="_7-interrupt-claim-process" tabindex="-1"><a class="header-anchor" href="#_7-interrupt-claim-process"><span>7. Interrupt Claim Process</span></a></h2><h2 id="_8-interrupt-completion" tabindex="-1"><a class="header-anchor" href="#_8-interrupt-completion"><span>8. Interrupt Completion</span></a></h2></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/Mes0903/Mes0903.github.io/edit/main/src/risc-v/PLIC/README.md" aria-label="Edit this page" rel="noopener noreferrer" target="_blank" iconsizing="both"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">Last update: </span><span class="vp-meta-info" data-allow-mismatch="text">2/22/2025, 7:26:29 PM</span></div><div class="contributors"><span class="vp-meta-label">Contributors: </span><!--[--><!--[--><span class="vp-meta-info" title="email: mes900903@gmail.com">Mes</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">The content on this site is all CC-BY-SA, or MIT/GPLv3+ dual license for code.</div><div class="vp-copyright">Copyright Â© 2025 Mes </div></footer></div><!--]--><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-C_w5Vw85.js" defer></script>
  </body>
</html>
