<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.19" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.71" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://mes0903.github.io/security/PE_file_format/"><meta property="og:site_name" content="Mes's Blog"><meta property="og:title" content="PE file format"><meta property="og:description" content="PE file format å‰è¨€ PE æ˜¯ Portable Executable çš„ç¸®å¯«ï¼Œå®ƒæ˜¯æ ¹æ“š UNIX ç³»çµ±çš„ COFF ä¾†è¨­è¨ˆçš„ï¼Œåœ¨ Windows ä¸‹æ‰€æœ‰çš„å¯åŸ·è¡Œæ–‡ä»¶éƒ½æ˜¯ PE Fileï¼Œåƒæ˜¯ EXEã€DLLã€SYSã€OCX ç­‰ç­‰ PE File å…§éƒ¨çš„æ ¼å¼æ˜¯è¦å®šå¥½çš„ï¼Œä¹Ÿå°±æ˜¯æ‰€è¬‚çš„ PE file formatï¼Œå¤§è‡´å¯ä»¥åˆ†ç‚ºå…©éƒ¨åˆ†ï¼ŒHea..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2025-02-22T20:43:16.000Z"><meta property="article:tag" content="security"><meta property="article:published_time" content="2023-01-09T00:00:00.000Z"><meta property="article:modified_time" content="2025-02-22T20:43:16.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"PE file format","image":[""],"datePublished":"2023-01-09T00:00:00.000Z","dateModified":"2025-02-22T20:43:16.000Z","author":[{"@type":"Person","name":"Mes","url":"https://mes0903.github.io"}]}</script><link rel="icon" href="/flame.ico"><title>PE file format | Mes's Blog</title><meta name="description" content="PE file format å‰è¨€ PE æ˜¯ Portable Executable çš„ç¸®å¯«ï¼Œå®ƒæ˜¯æ ¹æ“š UNIX ç³»çµ±çš„ COFF ä¾†è¨­è¨ˆçš„ï¼Œåœ¨ Windows ä¸‹æ‰€æœ‰çš„å¯åŸ·è¡Œæ–‡ä»¶éƒ½æ˜¯ PE Fileï¼Œåƒæ˜¯ EXEã€DLLã€SYSã€OCX ç­‰ç­‰ PE File å…§éƒ¨çš„æ ¼å¼æ˜¯è¦å®šå¥½çš„ï¼Œä¹Ÿå°±æ˜¯æ‰€è¬‚çš„ PE file formatï¼Œå¤§è‡´å¯ä»¥åˆ†ç‚ºå…©éƒ¨åˆ†ï¼ŒHea...">
    <link rel="preload" href="/assets/style-DW1OEkiQ.css" as="style"><link rel="stylesheet" href="/assets/style-DW1OEkiQ.css">
    <link rel="modulepreload" href="/assets/app-BcP8o8U4.js"><link rel="modulepreload" href="/assets/index.html-BcHUWuuC.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-BiEWK1GR.js" as="script"><link rel="prefetch" href="/assets/index.html-B_H8OoE4.js" as="script"><link rel="prefetch" href="/assets/index.html-B6QgGw1I.js" as="script"><link rel="prefetch" href="/assets/index.html-CfApM9ED.js" as="script"><link rel="prefetch" href="/assets/index.html-CsGh_Sko.js" as="script"><link rel="prefetch" href="/assets/index.html-CackVi67.js" as="script"><link rel="prefetch" href="/assets/index.html-ZJwihc1a.js" as="script"><link rel="prefetch" href="/assets/index.html-BLPTrtIz.js" as="script"><link rel="prefetch" href="/assets/index.html-BkR214TD.js" as="script"><link rel="prefetch" href="/assets/index.html-SiEU4OdJ.js" as="script"><link rel="prefetch" href="/assets/index.html-BvIw9pTT.js" as="script"><link rel="prefetch" href="/assets/index.html-BnqPezdy.js" as="script"><link rel="prefetch" href="/assets/index.html-C2EEiO23.js" as="script"><link rel="prefetch" href="/assets/AboutMovingForward.html-BVXUatD0.js" as="script"><link rel="prefetch" href="/assets/RasterI.html-DZu6U60_.js" as="script"><link rel="prefetch" href="/assets/index.html-BnPU3ndH.js" as="script"><link rel="prefetch" href="/assets/index.html-CDWGPQj5.js" as="script"><link rel="prefetch" href="/assets/index.html-BZAA8teD.js" as="script"><link rel="prefetch" href="/assets/index.html-B29x6D-I.js" as="script"><link rel="prefetch" href="/assets/index.html-d9TxGGlK.js" as="script"><link rel="prefetch" href="/assets/index.html-x0TChf0P.js" as="script"><link rel="prefetch" href="/assets/index.html-RUmwL0vR.js" as="script"><link rel="prefetch" href="/assets/index.html-DiP1_nrU.js" as="script"><link rel="prefetch" href="/assets/index.html-CWhwJJRF.js" as="script"><link rel="prefetch" href="/assets/index.html-DUBF5UHc.js" as="script"><link rel="prefetch" href="/assets/index.html-B1-KcoWy.js" as="script"><link rel="prefetch" href="/assets/index.html-DjRvgdxh.js" as="script"><link rel="prefetch" href="/assets/risc-v_osdi.html-CF5-ccKo.js" as="script"><link rel="prefetch" href="/assets/index.html-ogpKYtWm.js" as="script"><link rel="prefetch" href="/assets/index.html-CLdwlagL.js" as="script"><link rel="prefetch" href="/assets/index.html-DsRYPjK6.js" as="script"><link rel="prefetch" href="/assets/index.html-CFCnu_oK.js" as="script"><link rel="prefetch" href="/assets/index.html-b5wTyc_O.js" as="script"><link rel="prefetch" href="/assets/index.html-CfBwqcOE.js" as="script"><link rel="prefetch" href="/assets/index.html-BJxZQvsX.js" as="script"><link rel="prefetch" href="/assets/index.html-DM0Dryhz.js" as="script"><link rel="prefetch" href="/assets/index.html-Bdi3atey.js" as="script"><link rel="prefetch" href="/assets/index.html-Db6XWDF4.js" as="script"><link rel="prefetch" href="/assets/index.html-BIMDrBZh.js" as="script"><link rel="prefetch" href="/assets/index.html-1WitTtjF.js" as="script"><link rel="prefetch" href="/assets/index.html-BBc1mo51.js" as="script"><link rel="prefetch" href="/assets/index.html-Da_dn3sB.js" as="script"><link rel="prefetch" href="/assets/index.html-bcnvj3fg.js" as="script"><link rel="prefetch" href="/assets/index.html-DBjWceTq.js" as="script"><link rel="prefetch" href="/assets/index.html-CYG3E7BE.js" as="script"><link rel="prefetch" href="/assets/index.html-Byh5ax_b.js" as="script"><link rel="prefetch" href="/assets/index.html-CPX4-oWw.js" as="script"><link rel="prefetch" href="/assets/404.html-CH4Ibaef.js" as="script"><link rel="prefetch" href="/assets/index.html-728yCafu.js" as="script"><link rel="prefetch" href="/assets/index.html-lyIe0CpS.js" as="script"><link rel="prefetch" href="/assets/index.html-Wzc89aeg.js" as="script"><link rel="prefetch" href="/assets/index.html-EsIA7Wqr.js" as="script"><link rel="prefetch" href="/assets/index.html-CRq7Djss.js" as="script"><link rel="prefetch" href="/assets/index.html-BNg86-sq.js" as="script"><link rel="prefetch" href="/assets/index.html-BuPK7MMf.js" as="script"><link rel="prefetch" href="/assets/index.html-CXd-1WE2.js" as="script"><link rel="prefetch" href="/assets/index.html-BPYKVIQl.js" as="script"><link rel="prefetch" href="/assets/index.html-Du47nPb9.js" as="script"><link rel="prefetch" href="/assets/index.html-BcGBAPVR.js" as="script"><link rel="prefetch" href="/assets/index.html-Bz_MoDKk.js" as="script"><link rel="prefetch" href="/assets/index.html-Cy6boZwT.js" as="script"><link rel="prefetch" href="/assets/index.html-Bgc2pn_w.js" as="script"><link rel="prefetch" href="/assets/index.html-Dqr7MINQ.js" as="script"><link rel="prefetch" href="/assets/index.html-B_kkQH4U.js" as="script"><link rel="prefetch" href="/assets/index.html-BrdzQkpQ.js" as="script"><link rel="prefetch" href="/assets/index.html-Blq7aT-q.js" as="script"><link rel="prefetch" href="/assets/index.html-axLJhkf5.js" as="script"><link rel="prefetch" href="/assets/index.html-DBWaheD3.js" as="script"><link rel="prefetch" href="/assets/index.html-DGxj-483.js" as="script"><link rel="prefetch" href="/assets/index.html-CarUXHpG.js" as="script"><link rel="prefetch" href="/assets/index.html-BHE8pNse.js" as="script"><link rel="prefetch" href="/assets/index.html-Dd-niVBl.js" as="script"><link rel="prefetch" href="/assets/index.html-BM7yhHKu.js" as="script"><link rel="prefetch" href="/assets/index.html-DL9y76Vc.js" as="script"><link rel="prefetch" href="/assets/index.html-DJXfLGA7.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-DXWKOczD.js" as="script"><link rel="prefetch" href="/assets/index-B-M8YVCw.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-slnMg1Ma.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><!--[--><div class="theme-container no-sidebar external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="Take me home"><img class="vp-nav-logo" src="/flame.jpg" alt><!----><span class="vp-site-name hide-in-pad">Mes&#39;s Blog</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!----><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->PE file format</h1><div class="page-info"><span class="page-author-info" aria-label="AuthorğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mes0903.github.io" target="_blank" rel="noopener noreferrer">Mes</a></span><span property="author" content="Mes"></span></span><!----><span class="page-date-info" aria-label="Writing DateğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">January 9, 2023</span><meta property="datePublished" content="2023-01-09T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 9 min</span><meta property="timeRequired" content="PT9M"></span><span class="page-category-info" aria-label="CategoryğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color6 clickable" role="navigation">security</span><!--]--><meta property="articleSection" content="security"></span><span class="page-tag-info" aria-label="TagğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color6 clickable" role="navigation">security</span><!--]--><meta property="keywords" content="security"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><!--[--><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#fileheader">FileHeader</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#optional-header-å¯é¸é ­">Optional Header (å¯é¸é ­)</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--]--><!----></aside></div><!----><div class="theme-hope-content" vp-content><h1 id="pe-file-format" tabindex="-1"><a class="header-anchor" href="#pe-file-format"><span>PE file format</span></a></h1><h1 id="å‰è¨€" tabindex="-1"><a class="header-anchor" href="#å‰è¨€"><span>å‰è¨€</span></a></h1><p>PE æ˜¯ Portable Executable çš„ç¸®å¯«ï¼Œå®ƒæ˜¯æ ¹æ“š UNIX ç³»çµ±çš„ COFF ä¾†è¨­è¨ˆçš„ï¼Œåœ¨ Windows ä¸‹æ‰€æœ‰çš„å¯åŸ·è¡Œæ–‡ä»¶éƒ½æ˜¯ PE Fileï¼Œåƒæ˜¯ EXEã€DLLã€SYSã€OCX ç­‰ç­‰</p><p>PE File å…§éƒ¨çš„æ ¼å¼æ˜¯è¦å®šå¥½çš„ï¼Œä¹Ÿå°±æ˜¯æ‰€è¬‚çš„ PE file formatï¼Œå¤§è‡´å¯ä»¥åˆ†ç‚ºå…©éƒ¨åˆ†ï¼ŒHeader èˆ‡ Sectionï¼š</p><!----><br><p>Header æ˜¯ç”¨ä¾†ç®¡ç† PE file çš„ï¼ŒåŒ…å«äº†ä¸€äº›åŸ·è¡Œæª”çš„é‡è¦è³‡è¨Šï¼Œè€Œ Section å‰‡åŒ…å«äº†ç¨‹å¼ç¢¼ã€å¸¸é‡ã€è³‡æ–™å’Œåœ–ç‰‡è³‡æºç­‰ç­‰</p><p>ç‚ºäº†å¾ŒçºŒè¬›è§£ï¼Œé€™é‚Šç”¨ asm å¯«äº†ä¸€å€‹å¾ˆç°¡å–®çš„ Windows Programï¼ŒåŸ·è¡Œæª”åç‚º demo.exeï¼š</p><div class="language-asm line-numbers-mode" data-highlighter="shiki" data-ext="asm" data-title="asm" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">; demo.asm</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">386</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    .model flat, stdcall</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    option </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">casemap:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">none</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">include \masm32\include\windows.</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">inc</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">include \masm32\include\kernel32.</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">inc</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">include \masm32\include\user32.</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">inc</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">include \masm32\include\masm32.</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">inc</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">includelib \masm32\lib\kernel32.lib</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">includelib \masm32\lib\user32.lib</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">includelib \masm32\lib\masm32.lib</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    .data</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">szCaptions  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &#39;hello&#39;, </span><span style="--shiki-light:#986801;--shiki-dark:#C678DD;">0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">szText  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &#39;Hello World!&#39;, </span><span style="--shiki-light:#986801;--shiki-dark:#C678DD;">0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    .code</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">start:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">    push</span><span style="--shiki-light:#986801;--shiki-dark:#C678DD;"> 0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">    lea</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> eax</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, szCaptions</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">    push</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> eax</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">    lea</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> eax</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, szText</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">    push</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> eax</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">    push</span><span style="--shiki-light:#986801;--shiki-dark:#C678DD;"> 0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">    call</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> MessageBox</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">    push</span><span style="--shiki-light:#986801;--shiki-dark:#C678DD;"> 0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">    call</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ExitProcess</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    end start</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”±æ–¼æˆ‘æ˜¯ç”¨ masm çµ„è­¯ï¼Œæ‰€ä»¥æŒ‡ä»¤å°±ä¸‹</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\masm32\bin\ml</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /Zd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /coff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> demo.asm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\masm32\bin\Link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /SUBSYSTEM:CONSOLE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> demo.obj</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘å€‘å¯ä»¥ç”¨ PE-bear é€™å€‹è»Ÿé«”ä¾†çœ‹ PE file çš„å…§å®¹ï¼Œé€™æ˜¯æˆ‘ç”¨ PEbear å°‡ demo.exe é–‹èµ·ä¾†çš„æ¨£è²Œï¼š</p><!----><br><p>å¯ä»¥çœ‹è¦‹ demo.exe ç”± DOS Header, DOS stub, NT Headers, Section Headers èˆ‡å¹¾å€‹ Sections çµ„æˆï¼Œé‚£æ¥ä¸‹ä¾†å°±æœƒä¾åºä»‹ç´¹é€™äº›æ±è¥¿</p><h1 id="dos-header" tabindex="-1"><a class="header-anchor" href="#dos-header"><span>DOS Header</span></a></h1><p>PE file æœ€ä¸€é–‹å§‹çš„éƒ¨åˆ†æ˜¯ Dos Headerï¼ŒPE-bear å¯ä»¥å¹«æˆ‘å€‘æŠŠé€™æ®µ binaryï¼š</p><!----><br><p>è§£æç‚ºé€™æ¨£ï¼š</p><!----><br><p>DOS Header æ˜¯ PE File ä¸­çš„èµ·å§‹ä½ç½®ï¼Œä»¥å‰çš„åŠŸç”¨æ˜¯ç”¨ä¾†ä¿æŒèˆ‡ DOS çš„å…¼å®¹æ€§èˆ‡å®šä½ NT Headerï¼Œè€Œç¾åœ¨çš„åŠŸç”¨åªå‰©ä¸‹å¾Œè€…</p><p>DOS Header æ˜¯ä¸€å€‹ C structï¼Œåœ¨ <code>winnt.h</code> ä¸­çš„å®šç¾©å¦‚ä¸‹ï¼š</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> _IMAGE_DOS_HEADER {</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      // DOS .EXE header</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_magic;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     // EXE ç°½å mz</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_cblp;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      // Bytes on last page of file</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_cp;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        // Pages in file</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_crlc;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      // Relocations</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_cparhdr;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   // Size of header in paragraphs</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_minalloc;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  // Minimum extra paragraphs needed</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_maxalloc;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  // Maximum extra paragraphs needed</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_ss;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        // Initial (relative) SS value</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_sp;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        // Initial SP value</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_csum;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      // Checksum</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_ip;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        // Initial IP value</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_cs;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        // Initial (relative) CS value</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_lfarlc;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    // File address of relocation table</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_ovno;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      // Overlay number</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">e_res</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    // Reserved words</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_oemid;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     // OEM identifier (for e_oeminfo)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   e_oeminfo;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   // OEM information; e_oemid specific</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD   </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">e_res2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  // Reserved words</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  LONG   e_lfanew;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    // NT Header ä½å€</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} IMAGE_DOS_HEADER, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">PIMAGE_DOS_HEADER;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®ƒçš„å¤§å°ç‚º <code>40h</code>(h ä»£è¡¨ç”¨åå…­é€²ä½è¡¨ç¤º)ï¼Œå…¶ä¸­ <code>WORD</code> æ˜¯ 2bytesï¼Œ<code>LONG</code> æ˜¯ 4bytesã€‚ æˆ‘å€‘é—œå¿ƒçš„åªæœ‰å…©å€‹æˆå“¡ï¼š<code>e_magic</code> èˆ‡ <code>e_lfanew</code></p><p><code>e_magic</code> æ˜¯ä¸€å€‹ç°½åï¼ŒASCII çš„è½‰æ›çµæœç‚º <code>MZ</code>ï¼Œæ‰€æœ‰çš„ PE file éƒ½è¦ä»¥é€™å€‹ <code>MZ</code> é–‹é ­ï¼›è€Œ <code>e_lfanew</code> æŒ‡å‘ NT Header çš„ä½å€ã€‚ å…¶å®ƒçš„å…ƒç´ æ˜¯åœ¨ DOS ç’°å¢ƒä¸‹è¦ä½¿ç”¨çš„ï¼Œåœ¨ Windows ä¸‹å°±ç„¡é—œ</p><p>è€Œ DOS Stub ä¹Ÿæ˜¯åœ¨ DOS ç’°å¢ƒä¸‹ä½¿ç”¨çš„ï¼Œä¸»è¦åŠŸèƒ½å°±æ˜¯æ‹¿ä¾†å ±éŒ¯ï¼Œé€™é‚Šä¹Ÿå°±ä¸è©³ç´°ä»‹ç´¹</p><h1 id="nt-headers-pe-headers" tabindex="-1"><a class="header-anchor" href="#nt-headers-pe-headers"><span>NT Headers (PE Headers)</span></a></h1><p>NT Headers ä¹Ÿæ˜¯ä¸€å€‹ C structï¼Œå®ƒåœ¨ <code>winnt.h</code> çš„å®šç¾©å¦‚ä¸‹ï¼š</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" data-title="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#ifdef</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> _WIN64</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> IMAGE_NT_HEADERS64                  IMAGE_NT_HEADERS;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> PIMAGE_NT_HEADERS64                 PIMAGE_NT_HEADERS;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#else</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> IMAGE_NT_HEADERS32                  IMAGE_NT_HEADERS;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> PIMAGE_NT_HEADERS32                 PIMAGE_NT_HEADERS;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#endif</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä¸­çš„ <code>32</code> èˆ‡ <code>64</code> å°±ä»£è¡¨ 32 ä½å…ƒå’Œ 64 ä½å…ƒï¼Œåœ¨ç·¨è­¯æœŸçš„æ™‚å€™å°±æœƒé¸æ“‡å¥½äº†</p><p>è€Œ <code>IMAGE_NT_HEADERS64</code> èˆ‡ <code>IMAGE_NT_HEADERS32</code> çš„å·®ç•°ä¹Ÿå¾ˆå°ï¼š</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" data-title="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> _IMAGE_NT_HEADERS64</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD Signature;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // PE ç°½å</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    IMAGE_FILE_HEADER FileHeader;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    IMAGE_OPTIONAL_HEADER64 OptionalHeader;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">IMAGE_NT_HEADERS64</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">PIMAGE_NT_HEADERS64</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> _IMAGE_NT_HEADERS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD Signature;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    IMAGE_FILE_HEADER FileHeader;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    IMAGE_OPTIONAL_HEADER32 OptionalHeader;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">IMAGE_NT_HEADERS32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">PIMAGE_NT_HEADERS32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹è¦‹åŸºæœ¬ä¸Šä¸€æ¨£çš„ï¼Œå·®ç•°åªåœ¨ Optional Header</p><p>ç¬¬ä¸€å€‹æˆå“¡ <code>Signature</code> æ˜¯ <code>PE File</code> çš„ç°½åï¼Œç°½åç‚º <code>PE</code>ï¼Œç”¨ PE-bear å¯ä»¥çœ‹è¦‹å…¶ binary ç‚º<br><code>00 00 45 50</code>(æ­¤ exe ç‚º little endian)</p><!----><br><h2 id="fileheader" tabindex="-1"><a class="header-anchor" href="#fileheader"><span>FileHeader</span></a></h2><p>FileHeader çš„å®šç¾©å¦‚ä¸‹ï¼š</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" data-title="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> _IMAGE_FILE_HEADER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD    Machine;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       // å¹³å°ï¼Œintel 386 ç‚º 0x014cï¼Œintel 64 ç‚º 0x0200</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD    NumberOfSections;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              // Section æ•¸é‡ï¼Œæœ€å¤š 96 å€‹å­—ç¯€</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  DWORD   TimeDateStamp;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 // ç·¨è­¯æ—¥æœŸ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  DWORD   PointerToSymbolTable;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  DWORD   NumberOfSymbols;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD    SizeOfOptionalHeader;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          // OptionalHeader å¤§å°, 32 ä½é€šå¸¸ç‚º E0ï¼Œ64 ä½é€šå¸¸ç‚º F0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  WORD    Characteristics;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               // æª”æ¡ˆå±¬æ€§ï¼ŒEXE é€šå¸¸ç‚º 010fï¼ŒDLL é€šå¸¸ç‚º 210e</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">IMAGE_FILE_HEADER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">PIMAGE_FILE_HEADER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Machine</code> è¡¨ç¤ºå¹³å°ï¼Œå¯èƒ½å¾—å€¼å¦‚ä¸‹ï¼š</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" data-title="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_UNKNOWN</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">           0</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_TARGET_HOST</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">       0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0001</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Useful for indicating we want to interact with the host and not a WoW guest.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_I386</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">              0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">014c</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Intel 386.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_R3000</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">             0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0162</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // MIPS little-endian, 0x160 big-endian</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_R4000</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">             0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0166</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // MIPS little-endian</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_R10000</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">            0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0168</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // MIPS little-endian</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_WCEMIPSV2</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">         0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0169</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // MIPS little-endian WCE v2</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_ALPHA</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">             0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0184</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Alpha_AXP</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_SH3</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">               0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">01a2</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // SH3 little-endian</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_SH3DSP</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">            0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">01a3</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_SH3E</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">              0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">01a4</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // SH3E little-endian</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_SH4</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">               0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">01a6</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // SH4 little-endian</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_SH5</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">               0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">01a8</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // SH5</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_ARM</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">               0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">01c0</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // ARM Little-Endian</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_THUMB</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">             0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">01c2</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // ARM Thumb/Thumb-2 Little-Endian</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_ARMNT</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">             0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">01c4</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // ARM Thumb-2 Little-Endian</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_AM33</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">              0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">01d3</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_POWERPC</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">           0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">01F0</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // IBM PowerPC Little-Endian</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_POWERPCFP</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">         0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">01f1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_IA64</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">              0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0200</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Intel 64</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_MIPS16</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">            0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0266</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // MIPS</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_ALPHA64</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">           0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0284</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // ALPHA64</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_MIPSFPU</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">           0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0366</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // MIPS</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_MIPSFPU16</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">         0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0466</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // MIPS</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_AXP64</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">             IMAGE_FILE_MACHINE_ALPHA64</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_TRICORE</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">           0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0520</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Infineon</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_CEF</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">               0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0CEF</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_EBC</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">               0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0EBC</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // EFI Byte Code</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_AMD64</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">             0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8664</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // AMD64 (K8)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_M32R</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">              0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">9041</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // M32R little-endian</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_ARM64</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">             0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">AA64</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // ARM64 Little-Endian</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_MACHINE_CEE</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">               0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">C0EE</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ demo.exe ä¾†èªªï¼Œå…¶å€¼ç‚º <code>014c</code></p><!----><br><p>é€™å¾ˆé•·ä¸€ä¸²ï¼Œç”¨åˆ°çš„æ™‚å€™å†æŸ¥å°±å¥½</p><p><code>TimeDateStamp</code> è¡¨ç¤ºç·¨è­¯æ—¥æœŸï¼›<code>SizeOfOptionalHeader</code> è¡¨ç¤º Optional Header çš„å¤§å°ï¼Œ32 bit çš„é›»è…¦é€šå¸¸ç‚º <code>0xE0</code>ï¼Œ64 bit é€šå¸¸ç‚º <code>0xF0</code></p><p>Characteristics è¨˜éŒ„äº†é€™å€‹æª”æ¡ˆçš„å±¬æ€§ï¼Œæœƒæ˜¯ä»¥ä¸‹é€™äº›å€¼å»åš <code>or</code> é‹ç®—ï¼š</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" data-title="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_RELOCS_STRIPPED</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">           0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0001</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Relocation info stripped from file.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_EXECUTABLE_IMAGE</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">          0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0002</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // File is executable  (i.e. no unresolved external references).</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_LINE_NUMS_STRIPPED</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">        0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0004</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Line nunbers stripped from file.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_LOCAL_SYMS_STRIPPED</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">       0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0008</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Local symbols stripped from file.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_AGGRESIVE_WS_TRIM</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">         0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0010</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Aggressively trim working set</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_LARGE_ADDRESS_AWARE</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">       0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0020</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // App can handle &gt;2gb addresses</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_BYTES_REVERSED_LO</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">         0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0080</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Bytes of machine word are reversed.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_32BIT_MACHINE</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">             0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0100</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // 32 bit word machine.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_DEBUG_STRIPPED</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">            0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0200</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Debugging info stripped from file in .DBG file</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_REMOVABLE_RUN_FROM_SWAP</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">   0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0400</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // If Image is on removable media, copy and run from the swap file.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_NET_RUN_FROM_SWAP</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">         0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0800</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // If Image is on Net, copy and run from the swap file.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_SYSTEM</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">                    0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // System File.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_DLL</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">                       0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2000</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // File is a DLL.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_UP_SYSTEM_ONLY</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">            0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4000</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // File should only be run on a UP machine</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_FILE_BYTES_REVERSED_HI</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">         0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8000</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Bytes of machine word are reversed.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ demo.exe ä¾†èªªå…¶å€¼ç‚º <code>0x010f</code>ï¼Œå› æ­¤æ˜¯ 1, 2, 4, 8, 100 åš <code>or</code> é‹ç®—</p><!----><br><h2 id="optional-header-å¯é¸é ­" tabindex="-1"><a class="header-anchor" href="#optional-header-å¯é¸é ­"><span>Optional Header (å¯é¸é ­)</span></a></h2><p>Optional Header é›–ç„¶æœ‰ <code>Optional</code> é€™è©åœ¨è£¡é¢ï¼Œä½†å®ƒæ˜¯ä¸€å®šè¦æœ‰çš„ï¼Œå…¶å®šç¾©å¦‚ä¸‹ï¼š</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" data-title="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> _IMAGE_OPTIONAL_HEADER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    //</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // Standard fields.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    //</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    WORD    Magic;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       // ç°½åï¼Œ 107h = ROM Imageï¼Œ 10Bh = EXE Imageï¼Œ20Bh = PE32+</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    BYTE    MajorLinkerVersion;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          // Linker ç‰ˆæœ¬è™Ÿ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    BYTE    MinorLinkerVersion;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   SizeOfCode;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  // æ‰€æœ‰å«æœ‰ç¨‹å¼ç¢¼çš„ Section å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   SizeOfInitializedData;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       // æ‰€æœ‰å«æœ‰åˆå§‹åŒ–æ•¸æ“šçš„ Section å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   SizeOfUninitializedData;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     // æ‰€æœ‰å«ä½æœªå§‹åŒ–æ•¸æ“šçš„ Section å¤§å°(ä¸ä½”ç”¨æª”æ¡ˆç©ºé–“ï¼Œè¼‰å…¥è¨˜æ†¶é«”å¾Œæ‰æœƒåˆ†é…ç©ºé–“)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   AddressOfEntryPoint;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         // Process åŸ·è¡Œå…¥å£ RVA(è·é›¢ PE è¼‰å…¥å¾Œåœ°å€çš„è·é›¢ï¼Œç—…æ¯’å’ŒåŠ å¯†ç¨‹å¼éƒ½æœƒä¿®æ”¹å…¶å€¼ï¼Œå¾è€Œç²å¾—ç¨‹å¼çš„æ§åˆ¶æ¬Šï¼›å°æ–¼ DLLï¼Œå¦‚æœæ²’æœ‰å…¥å£å‡½å¼ï¼Œé‚£éº¼å°±æ˜¯ 0ï¼›å°æ–¼é©…å‹•å…¶å€¼ç‚ºåˆå§‹åŒ–çš„å‡½å¼åœ°å€)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   BaseOfCode;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  // ç¨‹å¼ç¢¼çš„ Section çš„èµ·å§‹ RVA(é€šå¸¸è·Ÿåœ¨ NT Header å¾Œ)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   BaseOfData;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  // æ•¸æ“šçš„ Section çš„èµ·å§‹ RVA </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    //</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // NT additional fields.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    //</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   ImageBase;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   // Process å»ºè­°çš„è¼‰å…¥åœ°å€</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   SectionAlignment;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            // è¨˜æ†¶é«”ä¸­çš„ Section å°é½Šå€¼</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   FileAlignment;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               // æª”æ¡ˆä¸­çš„ Section å°é½Šå€¼</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    WORD    MajorOperatingSystemVersion;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // OS ç‰ˆæœ¬è™Ÿ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    WORD    MinorOperatingSystemVersion;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    WORD    MajorImageVersion;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           // PE ç‰ˆæœ¬è™Ÿ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    WORD    MinorImageVersion;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    WORD    MajorSubsystemVersion;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       // éœ€è¦çš„ Subsystem ç‰ˆæœ¬è™Ÿ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    WORD    MinorSubsystemVersion;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   Win32VersionValue;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           // æœªä½¿ç”¨ï¼Œå¿…é ˆç‚º 0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   SizeOfImage;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 // è¨˜æ†¶é«”ä¸­æ•´å€‹ PE æª”æ¡ˆçš„ image å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   SizeOfHeaders;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               // æ‰€æœ‰çš„ Header èˆ‡ Section Header åŠ èµ·ä¾†çš„å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   CheckSum;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    // æª¢é©—å€¼ï¼Œä¸€èˆ¬æ–‡ä»¶ç‚º 0ï¼ŒDLL å’Œ SYS å‰‡æœƒæœ‰å…¶è¨­å®šçš„å€¼</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    WORD    Subsystem;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   // æª”æ¡ˆå­ç³»çµ±</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    WORD    DllCharacteristics;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          // DLL æª”æ¡ˆç‰¹æ€§</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   SizeOfStackReserve;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          // åˆå§‹åŒ–æ™‚ä¿ç•™çš„ stack å¤§å° (é è¨­ 1M)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   SizeOfStackCommit;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           // åˆå§‹åŒ–æ™‚å¯¦éš›çµ¦äºˆçš„ stack å¤§å° (é è¨­ 4K)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   SizeOfHeapReserve;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           // åˆå§‹åŒ–æ™‚ä¿ç•™çš„ Heap å¤§å° (é è¨­ 1M)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   SizeOfHeapCommit;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            // åˆå§‹åŒ–æ™‚å¯¦éš›çµ¦äºˆçš„ Heap å¤§å° (é è¨­ 4K)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   LoaderFlags;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 // åŠ è¼‰æ——å¹Ÿï¼Œé€šå¸¸æ˜¯ 0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   NumberOfRvaAndSizes;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         // æ•¸æ“šç›®éŒ„çš„æ•¸é‡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    IMAGE_DATA_DIRECTORY </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">DataDirectory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // æ•¸æ“šç›®éŒ„çš„é™£åˆ—</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">IMAGE_OPTIONAL_HEADER32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">PIMAGE_OPTIONAL_HEADER32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="section-headers-å€æ®µé ­" tabindex="-1"><a class="header-anchor" href="#section-headers-å€æ®µé ­"><span>Section Headers (å€æ®µé ­)</span></a></h1><p>Section Header æœƒè¨˜éŒ„æ¯å€‹ Section çš„è³‡è¨Šï¼Œå®šç¾©å¦‚ä¸‹ï¼š</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" data-title="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_SIZEOF_SHORT_NAME</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">              8</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> _IMAGE_SECTION_HEADER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    BYTE    </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">Name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[IMAGE_SIZEOF_SHORT_NAME];</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       // å€æ®µåï¼Œå¦‚ .text æˆ– .data</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    union</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            DWORD   PhysicalAddress;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            DWORD   VirtualSize;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 // å€æ®µå¤§å°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    } Misc;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   VirtualAddress;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      // å€æ®µçš„ä½ç§» (RVA)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   SizeOfRawData;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       // Section åœ¨æª”æ¡ˆä¸­å°é½Šå¾Œçš„å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   PointerToRawData;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    // Section åœ¨æª”æ¡ˆä¸­çš„åç§»é‡ (FOA)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   PointerToRelocations;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                // åœ¨ OBJ æ–‡ä»¶ä¸­ä½¿ç”¨</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   PointerToLinenumbers;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                // è¡Œè™Ÿè¡¨çš„ä½ç½®(debug æ™‚ä½¿ç”¨)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    WORD    NumberOfRelocations;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 // åœ¨ OBJ æ–‡ä»¶ä¸­ä½¿ç”¨</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    WORD    NumberOfLinenumbers;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 // è¡Œè™Ÿè¡¨ä¸­è¡Œè™Ÿçš„æ•¸é‡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    DWORD   Characteristics;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     // Section å±¬æ€§</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">IMAGE_SECTION_HEADER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">PIMAGE_SECTION_HEADER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IMAGE_SIZEOF_SECTION_HEADER</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">          40</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¯å€‹ Section Header æœƒæŒ‡å‘å°æ‡‰çš„ Sectionï¼Œåƒæ˜¯é€™æ¨£</p><!----><br><p>Section Header åªè² è²¬è¨˜éŒ„å°æ‡‰ Section çš„é‡è¦å±¬æ€§ï¼Œåƒæ˜¯ Section çš„åå­—ï¼Œå¤§å°ï¼ŒRVA ç­‰ç­‰</p><h1 id="section-å€æ®µ" tabindex="-1"><a class="header-anchor" href="#section-å€æ®µ"><span>Section(å€æ®µ)</span></a></h1><p>åœ¨ Headers ä¹‹å¾Œæ¥çš„å°±æ˜¯å„å€‹ Sectionï¼Œåƒæ˜¯å¤§å®¶ç†Ÿæ‚‰çš„ <code>.text</code>ã€<code>.data</code> ç­‰ç­‰éƒ½æ˜¯å€‹ Section</p><p><code>.text</code> é€šå¸¸æœƒæ˜¯ç¬¬ä¸€å€‹ Sectionï¼Œæ˜¯ä½ å¯åŸ·è¡Œç¨‹å¼ç¢¼æ‰€åœ¨çš„ä½ç½®ï¼ŒåŸ·è¡Œæª”çš„é€²å…¥é»é€šå¸¸ä¹Ÿæœƒåœ¨é€™è£¡</p><p><code>.data</code> æ®µå‰‡æ˜¯æ”¾ä½ çš„æ•¸æ“šï¼Œåƒæ˜¯æˆ‘å€‘ <code>std::cout &lt;&lt; &quot;Hello&quot;;</code>ï¼Œé‚£éº¼ <code>&quot;Hello&quot;</code> é€™å€‹è³‡æ–™å°±æœƒæ”¾åœ¨ <code>.data</code> è£¡é¢</p><p>å…¶ä»–é‚„æœ‰å¾ˆå¤šï¼Œä¸Šé¢çš„åœ–ä¹Ÿå¯ä»¥å¤§æ¦‚çœ‹åˆ°ï¼Œæœ‰èˆˆè¶£çš„å¯ä»¥æŸ¥ä¸€ä¸‹ï¼Œé€™é‚Šå°±ä¸è´…è¿°</p><h1 id="vaã€rvaã€foa" tabindex="-1"><a class="header-anchor" href="#vaã€rvaã€foa"><span>VAã€RVAã€FOA</span></a></h1><p>è€Œä¸€å€‹ PE åœ¨ç¡¬ç¢Ÿèˆ‡åœ¨è¨˜æ†¶é«”ä¸­çš„åç§»é‡æœƒæœ‰æ‰€ä¸åŒï¼Œé€™é‚Šæœƒæœ‰ä¸‰å€‹åè©å…ˆä»‹ç´¹ä¸€ä¸‹ï¼š</p><ul><li>VA: è™›æ“¬ä½å€(Virtual Address)ï¼ŒæŒ‡ PE æª”æ¡ˆè¼‰å…¥ã€Œè¨˜æ†¶é«”ã€å¾Œçš„ä½å€</li><li>RVA: ç›¸å°è™›æ“¬ä½å€(Relative Virtual Address)ï¼Œæ˜¯ PE æª”æ¡ˆä¸­è³‡æ–™ã€Section ç­‰åœ¨ã€Œè¨˜æ†¶é«”ã€ä¸­çš„åç§»é‡</li><li>FOA: æ–‡ä»¶åç§»ä½å€(File Offset Address)ï¼Œæ˜¯ PE æª”æ¡ˆä¸­è³‡æ–™ã€Section ç­‰åœ¨ã€Œç¡¬ç¢Ÿã€ä¸­çš„åç§»é‡</li></ul><p>æˆ‘å€‘çœ‹å¼µåœ–ä¾†è§£é‡‹ï¼š</p><!----><br><p>é€™é‚Šå‡è¨­æ¯å€‹ Section çš„å¤§å°éƒ½å°æ–¼ Alignment çš„å¤§å°ï¼Œæ‰€ä»¥ä¸€å€‹ Section çš„å¤§å°å°±æ˜¯ä¸€å€‹ Alignment çš„å¤§å°ã€‚x86 ä¸‹ FileAlignment é€šå¸¸æ˜¯ <code>0x200</code>ï¼Œä¹Ÿå°±æ˜¯ 512 bytesï¼Œé€™ä¹Ÿæ˜¯ä¸€å€‹ç¡¬ç¢Ÿæ‰‡å€çš„å¤§å°ã€‚è€Œ x86 ä¸‹ SectionAlignment é€šå¸¸æ˜¯ <code>0x1000</code></p><p>è€Œ Section é–‹å§‹çš„ä½å€ç‚º Base çš„ä½å€åŠ ä¸Šå…¶åç§»é‡ï¼Œåœ¨ç¡¬ç¢Ÿä¸­ï¼ŒBase çš„ä½å€ç‚º 0ï¼Œåç§»é‡å‰‡æ˜¯ <code>PointerToRawData</code> æ±ºå®šçš„ï¼Œä¹Ÿå°±æ˜¯ FOA</p><p>åœ¨è¨˜æ†¶é«”ä¸­ï¼ŒBase çš„ä½å€ç‚º Imagebase çš„ä½å€ï¼Œç„¶è€Œé€™æ˜¯å°ç¬¬ä¸€å€‹è¼‰å…¥è¨˜æ†¶é«”çš„ PE è€Œè¨€ï¼Œç•¶ Imagebase è™•å·²ç¶“æœ‰ PE è¼‰å…¥æ™‚ï¼ŒOS æœƒä»‹å…¥èª¿æ•´è¼‰å…¥ä½å€ï¼Œå› æ­¤æˆ‘å€‘å¸¸èªª Imagebase ç‚ºã€Œå»ºè­°è¼‰å…¥ã€ä½å€ï¼Œè€Œè¨˜æ†¶é«”ä¸­ Section çš„åç§»é‡å‰‡æ˜¯ <code>VirtualAddress</code> çš„æ•¸å€¼ï¼Œä¹Ÿå°±æ˜¯ RVAï¼ŒRVA çš„æ•¸å€¼åŠ ä¸Š Base çš„ä½å€å‰‡æ˜¯ Section åœ¨è¨˜æ†¶é«”ä¸Šçš„ä½å€ï¼Œç¨±ç‚º VAï¼Œå› æ­¤ VA = RVA + Imagebase</p></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/Mes0903/Mes0903.github.io/edit/main/src/security/PE_file_format/README.md" aria-label="Edit this page" rel="noopener noreferrer" target="_blank" iconsizing="both"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">Last update: </span><span class="vp-meta-info" data-allow-mismatch="text">2/23/2025, 4:43:16 AM</span></div><div class="contributors"><span class="vp-meta-label">Contributors: </span><!--[--><!--[--><span class="vp-meta-info" title="email: mes900903@gmail.com">Mes</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">The content on this site is all CC-BY-SA, or MIT/GPLv3+ dual license for code.</div><div class="vp-copyright">Copyright Â© 2025 Mes </div></footer></div><!--]--><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BcP8o8U4.js" defer></script>
  </body>
</html>
